<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>115å­¸æ¸¬è‹±æ–‡æ¨¡æ“¬è©¦é¡Œ(å››)</title>
  <style>
    /* å…¨å±€è¨­å®š */
    body { font-family: Arial, "Noto Sans TC", sans-serif; margin: 20px; line-height: 1.6; background-color: #f4f4f4; color: #333; }
    h1, h2, h3 { color: #2c3e50; }
    h1 { text-align: center; margin-bottom: 30px; }
    h2 { margin-top: 0; border-bottom: 2px solid #2c3e50; padding-bottom: 10px; margin-bottom: 20px;}
    
    .quiz-section { background: #fff; margin-top: 30px; padding: 30px; border: 1px solid #ddd; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); }
    .question { margin-bottom: 20px; padding-bottom: 15px; border-bottom: 1px solid #eee; }
    .question:last-child { border-bottom: none; }
    .qtext { font-weight: bold; margin-bottom: 8px; font-size: 1.05rem; }
    
    .cloze-passage, .passage { background: #f8fbfd; padding: 20px 25px; border-left: 5px solid #2980b9; margin-bottom: 25px; line-height: 1.9; text-align: justify; border-radius: 4px; font-size: 1.05rem; }
    .group-title { font-weight: bold; color: #e67e22; margin-top: 30px; margin-bottom: 15px; font-size: 1.2em; border-bottom: 2px solid #e67e22; display: inline-block; }

    label { display: block; margin-left: 15px; margin-top: 5px; cursor: pointer; transition: background 0.2s; padding: 4px 8px; border-radius: 4px; }
    label:hover { background-color: #f0f0f0; }
    select { margin-left: 5px; padding: 5px; border-radius: 4px; border: 1px solid #ccc; font-size: 1rem;}
    
    .controls { display: flex; flex-wrap: wrap; gap: 12px; align-items: center; padding: 15px; background: #fff; border: 1px solid #e5e5e5; border-radius: 10px; margin-bottom: 20px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); position: sticky; top: 0; z-index: 100; }
    button { padding: 10px 18px; font-size: 15px; cursor: pointer; border-radius: 6px; border: none; transition: all 0.3s; font-weight: bold; }
    .primary { background: #2563eb; color: white; }
    .primary:hover { background: #1d4ed8; }
    .secondary { background: #e5e7eb; color: #111; }
    .secondary:hover { background: #d1d5db; }
    .danger { background: #dc2626; color: white; }
    .danger:hover { background: #b91c1c; }
    button:disabled { opacity: 0.6; cursor: not-allowed; }

    .correct-answer { display: none; color: #16a34a; font-weight: bold; margin-left: 10px; background: #e8f5e9; padding: 2px 5px; border-radius: 3px;}
    .wrong { color: #dc2626; }
    .correct { color: #16a34a; font-weight: bold; }
    #results { margin-top: 20px; padding: 20px; border: 2px solid #ddd; border-radius: 10px; background: #fff;}
    
    #timer { font-weight: bold; color: #d35400; min-width: 80px; font-size: 1.2rem;}
    .locked-banner { display: none; padding: 15px; background: #fff3cd; color: #856404; border: 1px solid #ffeeba; border-radius: 8px; margin-bottom: 20px; text-align: center; font-weight: bold; font-size: 1.2rem; }

    /* ä½œæ–‡å€å¡Šæ¨£å¼ */
    .essay-container { display: flex; flex-direction: column; gap: 10px; }
    textarea#essayInput { width: 100%; height: 350px; padding: 15px; border: 1px solid #ccc; border-radius: 8px; font-family: Arial, sans-serif; font-size: 16px; line-height: 1.6; resize: vertical; box-sizing: border-box; }
    .word-count { text-align: right; font-size: 0.9rem; color: #666; }
    .ai-grading-result { margin-top: 15px; padding: 20px; background-color: #f0fdf4; border: 1px solid #bbf7d0; border-radius: 8px; display: none; }
    .score-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 10px; margin-bottom: 15px; }
    .score-item { background: white; padding: 10px; border-radius: 6px; text-align: center; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
    .score-label { font-size: 0.85rem; color: #555; display: block; }
    .score-value { font-size: 1.5rem; font-weight: bold; color: #16a34a; }
    .total-score { font-size: 1.3rem; font-weight: bold; border-top: 2px solid #eee; padding-top: 15px; margin-top: 10px; text-align: center; color: #2c3e50;}
  </style>
</head>
<body>

  <h1>115å­¸æ¸¬è‹±æ–‡æ¨¡æ“¬è©¦é¡Œ(å››)</h1>

  <div class="controls">
    <label for="countdownTime" style="margin:0;">å€’æ•¸è¨ˆæ™‚ï¼ˆåˆ†ï¼‰ï¼š</label>
    <select id="countdownTime">
      <option value="30">30</option>
      <option value="45">45</option>
      <option value="60" selected>60</option>
      <option value="75">75</option>
      <option value="90">90</option>
    </select>
    <button class="primary" id="startBtn" type="button">é–‹å§‹å€’æ•¸</button>
    <button class="secondary" id="pauseBtn" type="button" disabled>æš«åœ</button>
    <button class="secondary" id="resumeBtn" type="button" disabled>ç¹¼çºŒ</button>
    <button class="danger" id="resetTimerBtn" type="button" disabled>é‡è¨­è¨ˆæ™‚</button>
    <span id="timer">å°šæœªé–‹å§‹</span>
  </div>
  
  <div id="lockedBanner" class="locked-banner">âš ï¸ æ™‚é–“åˆ°ï¼æ‰€æœ‰ä½œç­”æ¬„ä½å·²é–å®šã€‚</div>

  <form id="examForm">
    <div class="quiz-section">
      <h2>ç¬¬ä¸€å¤§é¡Œï¼šè©å½™æ¸¬é©—ï¼ˆ1â€“10 é¡Œï¼‰</h2>
      <div class="question"><div class="qtext">1. She was ______ to tell the truth because she didn't want to hurt her friend's feelings, so she kept quiet.</div><div class="options"><label><input type="radio" name="q1" value="A"> A. reluctant</label><label><input type="radio" name="q1" value="B"> B. efficient</label><label><input type="radio" name="q1" value="C"> C. innocent</label><label><input type="radio" name="q1" value="D"> D. magnificent</label></div></div>
      <div class="question"><div class="qtext">2. The loud explosion seemed to ______ the birds in the park, causing them to fly away in panic.</div><div class="options"><label><input type="radio" name="q2" value="A"> A. delight</label><label><input type="radio" name="q2" value="B"> B. frighten</label><label><input type="radio" name="q2" value="C"> C. comfort</label><label><input type="radio" name="q2" value="D"> D. admire</label></div></div>
      <div class="question"><div class="qtext">3. This restaurant has an excellent ______ for serving the most authentic Italian food in the city.</div><div class="options"><label><input type="radio" name="q3" value="A"> A. calculation</label><label><input type="radio" name="q3" value="B"> B. reputation</label><label><input type="radio" name="q3" value="C"> C. population</label><label><input type="radio" name="q3" value="D"> D. transportation</label></div></div>
      <div class="question"><div class="qtext">4. The organizers ______ a huge crowd at the outdoor concert because the weather forecast is perfect.</div><div class="options"><label><input type="radio" name="q4" value="A"> A. participate</label><label><input type="radio" name="q4" value="B"> B. demonstrate</label><label><input type="radio" name="q4" value="C"> C. anticipate</label><label><input type="radio" name="q4" value="D"> D. investigate</label></div></div>
      <div class="question"><div class="qtext">5. Please handle these wine glasses with care; they are extremely ______ and can break easily.</div><div class="options"><label><input type="radio" name="q5" value="A"> A. accurate</label><label><input type="radio" name="q5" value="B"> B. desperate</label><label><input type="radio" name="q5" value="C"> C. delicate</label><label><input type="radio" name="q5" value="D"> D. immediate</label></div></div>
      <div class="question"><div class="qtext">6. The author made a subtle ______ to Greek mythology in her novel, which only educated readers would notice.</div><div class="options"><label><input type="radio" name="q6" value="A"> A. allusion</label><label><input type="radio" name="q6" value="B"> B. illusion</label><label><input type="radio" name="q6" value="C"> C. dimension</label><label><input type="radio" name="q6" value="D"> D. expansion</label></div></div>
      <div class="question"><div class="qtext">7. The spicy sauce serves as a perfect ______ to the grilled chicken, enhancing its flavor significantly.</div><div class="options"><label><input type="radio" name="q7" value="A"> A. replacement</label><label><input type="radio" name="q7" value="B"> B. compliment</label><label><input type="radio" name="q7" value="C"> C. complement</label><label><input type="radio" name="q7" value="D"> D. requirement</label></div></div>
      <div class="question"><div class="qtext">8. According to the schedule, a brief opening speech will ______ the awards ceremony.</div><div class="options"><label><input type="radio" name="q8" value="A"> A. proceed</label><label><input type="radio" name="q8" value="B"> B. persuade</label><label><input type="radio" name="q8" value="C"> C. provide</label><label><input type="radio" name="q8" value="D"> D. precede</label></div></div>
      <div class="question"><div class="qtext">9. Despite the scandal, the politician managed to ______ the storm and win the re-election.</div><div class="options"><label><input type="radio" name="q9" value="A"> A. fracture</label><label><input type="radio" name="q9" value="B"> B. dissolve</label><label><input type="radio" name="q9" value="C"> C. scatter</label><label><input type="radio" name="q9" value="D"> D. weather</label></div></div>
      <div class="question"><div class="qtext">10. The accountant was fired after he was caught trying to ______ the financial reports to hide the losses.</div><div class="options"><label><input type="radio" name="q10" value="A"> A. monitor</label><label><input type="radio" name="q10" value="B"> B. doctor</label><label><input type="radio" name="q10" value="C"> C. tutor</label><label><input type="radio" name="q10" value="D"> D. sponsor</label></div></div>
    </div>

    <div class="quiz-section">
      <h2>ç¬¬äºŒå¤§é¡Œï¼šç¶œåˆæ¸¬é©—ï¼ˆ11â€“20 é¡Œï¼‰</h2>
      <div class="group-title">é¡Œçµ„ Aï¼ˆ11â€“15 é¡Œï¼‰</div>
      <div class="passage"><p>Water scarcity has undoubtedly become one of the most pressing environmental challenges of the 21st century. As global temperatures rise, climate change has severely disrupted global weather patterns, (11) _____ prolonged droughts and unpredictable rainfall in many regions. Consequently, reservoirs play a more critical role than ever in stabilizing our water supply. These essential man-made lakes collect rainwater during wet seasons, ensuring that there is enough water (12) _____ for agricultural, industrial, and domestic use during dry spells.</p><p>However, the system is fragile. When reservoir levels drop dangerously low due to a distinct lack of rain, the consequences can be severe. Governments may be forced to implement strict rationing measures, and the sheer (13) _____ of the situation often catches the public off guard. To prevent a total collapse of the water supply system, immediate action is required from everyone. We must adopt more sustainable habits and fix leaking pipes immediately. It is imperative that we value every drop before we eventually (14) _____ this precious resource. Otherwise, our future generations will be forced to (15) _____ the devastating consequences of our negligence.</p></div>
      <div class="question"><div class="qtext">11.</div><div class="options"><label><input type="radio" name="q11" value="A"> A. causing</label><label><input type="radio" name="q11" value="B"> B. caused</label><label><input type="radio" name="q11" value="C"> C. to cause</label><label><input type="radio" name="q11" value="D"> D. cause</label></div></div>
      <div class="question"><div class="qtext">12.</div><div class="options"><label><input type="radio" name="q12" value="A"> A. stores</label><label><input type="radio" name="q12" value="B"> B. stored</label><label><input type="radio" name="q12" value="C"> C. storing</label><label><input type="radio" name="q12" value="D"> D. to store</label></div></div>
      <div class="question"><div class="qtext">13.</div><div class="options"><label><input type="radio" name="q13" value="A"> A. capacity</label><label><input type="radio" name="q13" value="B"> B. identity</label><label><input type="radio" name="q13" value="C"> C. severity</label><label><input type="radio" name="q13" value="D"> D. variety</label></div></div>
      <div class="question"><div class="qtext">14.</div><div class="options"><label><input type="radio" name="q14" value="A"> A. come down with</label><label><input type="radio" name="q14" value="B"> B. look up to</label><label><input type="radio" name="q14" value="C"> C. get rid of</label><label><input type="radio" name="q14" value="D"> D. run out of</label></div></div>
      <div class="question"><div class="qtext">15.</div><div class="options"><label><input type="radio" name="q15" value="A"> A. bear</label><label><input type="radio" name="q15" value="B"> B. charge</label><label><input type="radio" name="q15" value="C"> C. defeat</label><label><input type="radio" name="q15" value="D"> D. occupy</label></div></div>

      <div class="group-title">é¡Œçµ„ Bï¼ˆ16â€“20 é¡Œï¼‰</div>
      <div class="passage"><p>Honeybees may be small insects, but they carry a huge responsibility on their tiny wings. As the world's most important pollinators, bees are responsible for pollinating about one-third of the food we eat, boosting agricultural economies worldwide. (16) _____, in recent years, bee populations have been declining at an alarming rateâ€”a troubling phenomenon known as Colony Collapse Disorder. Scientists have identified several factors contributing to this crisis, including the heavy use of pesticides, massive habitat loss, and climate change.</p><p>The potential (17) _____ of bees poses a serious threat to global food security. Without them, many crops, such as apples, almonds, and broccoli, would struggle to reproduce. Another major issue complicating the situation is the spread of diseases and parasites (18) _____ weaken the hives from within. To reverse this trend, conservationists are urging farmers to reduce chemical usage and plant more wildflowers. It is (19) _____ for us to protect these hardworking insects before it is too late. If the bees disappear completely, the ecosystem will suffer (20) _____ damage that cannot be easily repaired.</p></div>
      <div class="question"><div class="qtext">16.</div><div class="options"><label><input type="radio" name="q16" value="A"> A. Furthermore</label><label><input type="radio" name="q16" value="B"> B. However</label><label><input type="radio" name="q16" value="C"> C. Therefore</label><label><input type="radio" name="q16" value="D"> D. Otherwise</label></div></div>
      <div class="question"><div class="qtext">17.</div><div class="options"><label><input type="radio" name="q17" value="A"> A. disappearance</label><label><input type="radio" name="q17" value="B"> B. maintenance</label><label><input type="radio" name="q17" value="C"> C. assistance</label><label><input type="radio" name="q17" value="D"> D. performance</label></div></div>
      <div class="question"><div class="qtext">18.</div><div class="options"><label><input type="radio" name="q18" value="A"> A. what</label><label><input type="radio" name="q18" value="B"> B. where</label><label><input type="radio" name="q18" value="C"> C. that</label><label><input type="radio" name="q18" value="D"> D. whose</label></div></div>
      <div class="question"><div class="qtext">19.</div><div class="options"><label><input type="radio" name="q19" value="A"> A. artificial</label><label><input type="radio" name="q19" value="B"> B. optional</label><label><input type="radio" name="q19" value="C"> C. reluctant</label><label><input type="radio" name="q19" value="D"> D. vital</label></div></div>
      <div class="question"><div class="qtext">20.</div><div class="options"><label><input type="radio" name="q20" value="A"> A. permanent</label><label><input type="radio" name="q20" value="B"> B. energetic</label><label><input type="radio" name="q20" value="C"> C. temporary</label><label><input type="radio" name="q20" value="D"> D. intimate</label></div></div>
    </div>

    <div class="quiz-section">
      <h2>ç¬¬ä¸‰å¤§é¡Œï¼šæ–‡æ„é¸å¡«ï¼ˆ21â€“30 é¡Œï¼‰</h2>
      <div class="passage"><p>Self-defense is often misconstrued as merely combat training, but its core philosophy is actually to ensure that conflicts do not (21) _____ into violence. True defense begins with situational awareness, which entails remaining vigilant about oneâ€™s immediate (22) _____ and identifying irregularities early. By avoiding high-risk scenarios, individuals can often resolve issues without having to (23) _____ physical force. Furthermore, projecting a confident demeanor through body language can serve to (24) _____ potential predators, who typically seek easy, unaware targets.</p><p>Should a physical assault become (25) _____, the primary objective shifts instantly from de-escalation to escape. Effective defense does not require brute strength but rather the strategic targeting of (26) _____ points on an aggressorâ€™s body, such as the eyes or throat. In high-stress situations where fine motor skills degrade, it is unwise to attempt to (27) _____ complex martial arts maneuvers. Instead, simple and (28) _____ actions are most likely to create an opening for safety. Using oneâ€™s voice to shout commands can also shock the attacker and attract attention.</p><p>Ultimately, mindset dictates survival. Fear is a natural reaction, but training allows individuals to channel that fear into focused action. Preserving oneâ€™s life must remain the (29) _____ concern, far outweighing the protection of material possessions or ego. Finally, learning to trust oneâ€™s (30) _____ is crucial; if a situation feels ominous, it usually is. Recognizing these subconscious warning signs is often the most powerful tool in personal safety.</p></div>
      <div class="passage"><p><strong>é¸é …ï¼š</strong> (A) vicinityã€€(B) dissuadeã€€(C) resort toã€€(D) inevitableã€€(E) vitalã€€(F) executeã€€(G) escalateã€€(H) paramountã€€(I) instinctsã€€(J) decisive</p>
        <div class="question-row" style="display: flex; gap: 20px; margin-bottom: 10px; flex-wrap: wrap;">
          <div class="question"><div class="qtext">21.</div><select name="q21"><option value="">--</option><option value="A">A</option><option value="B">B</option><option value="C">C</option><option value="D">D</option><option value="E">E</option><option value="F">F</option><option value="G">G</option><option value="H">H</option><option value="I">I</option><option value="J">J</option></select></div>
          <div class="question"><div class="qtext">22.</div><select name="q22"><option value="">--</option><option value="A">A</option><option value="B">B</option><option value="C">C</option><option value="D">D</option><option value="E">E</option><option value="F">F</option><option value="G">G</option><option value="H">H</option><option value="I">I</option><option value="J">J</option></select></div>
          <div class="question"><div class="qtext">23.</div><select name="q23"><option value="">--</option><option value="A">A</option><option value="B">B</option><option value="C">C</option><option value="D">D</option><option value="E">E</option><option value="F">F</option><option value="G">G</option><option value="H">H</option><option value="I">I</option><option value="J">J</option></select></div>
          <div class="question"><div class="qtext">24.</div><select name="q24"><option value="">--</option><option value="A">A</option><option value="B">B</option><option value="C">C</option><option value="D">D</option><option value="E">E</option><option value="F">F</option><option value="G">G</option><option value="H">H</option><option value="I">I</option><option value="J">J</option></select></div>
          <div class="question"><div class="qtext">25.</div><select name="q25"><option value="">--</option><option value="A">A</option><option value="B">B</option><option value="C">C</option><option value="D">D</option><option value="E">E</option><option value="F">F</option><option value="G">G</option><option value="H">H</option><option value="I">I</option><option value="J">J</option></select></div>
        </div>
        <div class="question-row" style="display: flex; gap: 20px; margin-bottom: 10px; flex-wrap: wrap;">
          <div class="question"><div class="qtext">26.</div><select name="q26"><option value="">--</option><option value="A">A</option><option value="B">B</option><option value="C">C</option><option value="D">D</option><option value="E">E</option><option value="F">F</option><option value="G">G</option><option value="H">H</option><option value="I">I</option><option value="J">J</option></select></div>
          <div class="question"><div class="qtext">27.</div><select name="q27"><option value="">--</option><option value="A">A</option><option value="B">B</option><option value="C">C</option><option value="D">D</option><option value="E">E</option><option value="F">F</option><option value="G">G</option><option value="H">H</option><option value="I">I</option><option value="J">J</option></select></div>
          <div class="question"><div class="qtext">28.</div><select name="q28"><option value="">--</option><option value="A">A</option><option value="B">B</option><option value="C">C</option><option value="D">D</option><option value="E">E</option><option value="F">F</option><option value="G">G</option><option value="H">H</option><option value="I">I</option><option value="J">J</option></select></div>
          <div class="question"><div class="qtext">29.</div><select name="q29"><option value="">--</option><option value="A">A</option><option value="B">B</option><option value="C">C</option><option value="D">D</option><option value="E">E</option><option value="F">F</option><option value="G">G</option><option value="H">H</option><option value="I">I</option><option value="J">J</option></select></div>
          <div class="question"><div class="qtext">30.</div><select name="q30"><option value="">--</option><option value="A">A</option><option value="B">B</option><option value="C">C</option><option value="D">D</option><option value="E">E</option><option value="F">F</option><option value="G">G</option><option value="H">H</option><option value="I">I</option><option value="J">J</option></select></div>
        </div>
      </div>
    </div>

    <div class="quiz-section">
      <h2>ç¬¬å››å¤§é¡Œï¼šç¯‡ç« çµæ§‹ï¼ˆ31â€“34 é¡Œï¼‰</h2>
      <div class="passage">
        <p>The landscape of social media is fundamentally shifting from a space for harmless sharing to a breeding ground for high-tech deception, largely driven by the terrifyingly rapid advancement of generative artificial intelligence. In the past, creating realistic special effects required Hollywood-level budgets and technical expertise, but today, "deepfake" technology has effectively democratized the creation of synthetic media, putting powerful tools into the hands of anyone with a smartphone. 31_____ Criminals and scammers now routinely utilize these accessible tools to create incredibly convincing videos of famous celebrities endorsing fake investment schemes or even impersonate specific family members in distress to solicit emergency funds from terrified relatives. 32_____ The seamless and hyper-realistic nature of these fabrications makes them nearly impossible for the average user to distinguish from reality, inevitably leading to significant financial losses and profound emotional distress for countless victims worldwide.</p>
        <p>Combatting this expanding digital epidemic has proven to be an exceedingly difficult uphill battle for both tech giants and government regulators. Social media platforms struggle desperately to filter out malicious content because the generative technology used to create fakes is evolving at a pace that far outstrips the defensive technology used to detect them. 33_____ While some responsible companies attempt to implement digital watermarks or visible labels for AI-generated content, malicious actors often operate on the dark web where rules are ignored, or they find sophisticated ways to strip these indicators before publication. Furthermore, the legal framework for prosecuting these digital crimes remains woefully inadequate, as digital borders are porous and jurisdiction is often unclear. 34_____ As technology continues to accelerate beyond the reach of current regulation, the digital world is fast becoming a hall of mirrors where truth is increasingly difficult to verify, leaving modern society with a profound and persistent dilemma that seems to have no immediate cure.</p>
      </div>
      <div class="passage">
        <p><strong>é¸é …ï¼š</strong></p>
        <p>(A) By exploiting the deep trust viewers instinctively place in these familiar faces, criminals manage to generate massive illicit profits.</p>
        <p>(B) Consequently, this never-ending technological cat-and-mouse game suggests that the threat will persist for the foreseeable future.</p>
        <p>(C) These sophisticated algorithms can synthesize audio and video that mimic real people with terrifying accuracy.</p>
        <p>(D) However, as soon as detection software is updated to catch new fakes, scammers simply tweak their algorithms to bypass it.</p>
        <p>(E) Fortunately, strict new international laws have successfully stopped the spread of all AI-generated misinformation on major platforms.</p>
        <div class="question-row" style="display: flex; gap: 20px; align-items: flex-start; flex-wrap: wrap;">
          <div class="question"><div class="qtext">31.</div><select name="q31"><option value="">--</option><option value="A">A</option><option value="B">B</option><option value="C">C</option><option value="D">D</option><option value="E">E</option></select></div>
          <div class="question"><div class="qtext">32.</div><select name="q32"><option value="">--</option><option value="A">A</option><option value="B">B</option><option value="C">C</option><option value="D">D</option><option value="E">E</option></select></div>
          <div class="question"><div class="qtext">33.</div><select name="q33"><option value="">--</option><option value="A">A</option><option value="B">B</option><option value="C">C</option><option value="D">D</option><option value="E">E</option></select></div>
          <div class="question"><div class="qtext">34.</div><select name="q34"><option value="">--</option><option value="A">A</option><option value="B">B</option><option value="C">C</option><option value="D">D</option><option value="E">E</option></select></div>
        </div>
      </div>
    </div>

    <div class="quiz-section">
      <h2>ç¬¬äº”å¤§é¡Œï¼šé–±è®€æ¸¬é©—ï¼ˆ35â€“46 é¡Œï¼‰</h2>
      <div class="passage">
        <h3>Passage 1</h3>
        <p>The preservation of cultural heritage has gained increasing attention in recent decades as communities worldwide recognize the importance of safeguarding their historical, artistic, and traditional assets for future generations. Cultural heritage encompasses both tangible elements, such as historical buildings, artifacts, and monuments, and intangible aspects, including languages, rituals, music, and traditional crafts. These elements collectively form the identity of communities and serve as bridges connecting past, present, and future.</p>
        <p>Preserving cultural heritage faces numerous challenges in the modern era. Urban development often threatens historical sites, while globalization can lead to the erosion of traditional practices and languages. Climate change poses additional risks, with rising sea levels and extreme weather events endangering vulnerable heritage sites. Furthermore, armed conflicts and looting have destroyed or displaced countless cultural treasures throughout history. The 2019 fire at Notre-Dame Cathedral in Paris and the destruction of ancient sites in conflict zones serve as stark reminders of cultural heritage's vulnerability.</p>
        <p>Despite these challenges, technological advancements offer new tools for heritage preservation. Digital documentation techniques, such as 3D scanning and photogrammetry, create detailed records of sites and artifacts that can survive even if the originals are damaged or destroyed. Virtual reality allows people to experience cultural heritage remotely, increasing accessibility while reducing physical wear on fragile sites. Additionally, DNA analysis and other scientific methods provide new insights into ancient artifacts and human remains, revealing previously unknown aspects of historical cultures.</p>
        <p>Community involvement is crucial for successful heritage preservation. When local communities actively participate in preservation efforts, they develop a stronger sense of ownership and commitment to maintaining their cultural assets. This approach also ensures that preservation respects living traditions and contemporary cultural practices rather than treating heritage as frozen in time. Educational programs that teach young people about their cultural heritage help ensure the transmission of knowledge and skills to future generations.</p>
        <p>Ultimately, preserving cultural heritage is not merely about protecting objects and buildings but about maintaining the diversity of human expression and knowledge. It fosters respect for different cultures, promotes sustainable development, and contributes to building peaceful societies. As we move forward in an increasingly interconnected world, balancing preservation with adaptation will remain essentialâ€”honoring tradition while allowing cultural expressions to evolve naturally in response to changing circumstances.</p>
      </div>
      <div class="question"><div class="qtext">35. Based on the passage, which scenario would best represent the preservation of intangible cultural heritage?</div><div class="options"><label><input type="radio" name="q35" value="A"> A. Restoring a 300-year-old temple using traditional building techniques</label><label><input type="radio" name="q35" value="B"> B. Digitally archiving ancient manuscripts in a museum collection</label><label><input type="radio" name="q35" value="C"> C. Teaching indigenous language and traditional weaving methods to youth</label><label><input type="radio" name="q35" value="D"> D. Establishing protective zones around historical archaeological sites</label></div></div>
      <div class="question"><div class="qtext">36. How does technology contribute to cultural heritage preservation according to the passage?</div><div class="options"><label><input type="radio" name="q36" value="A"> A. By replacing traditional preservation methods completely</label><label><input type="radio" name="q36" value="B"> B. By creating detailed digital records that can survive physical damage</label><label><input type="radio" name="q36" value="C"> C. By making physical preservation of sites unnecessary</label><label><input type="radio" name="q36" value="D"> D. By focusing exclusively on tangible heritage elements</label></div></div>
      <div class="question"><div class="qtext">37. Why is community involvement important in heritage preservation?</div><div class="options"><label><input type="radio" name="q37" value="A"> A. It reduces the need for international cooperation</label><label><input type="radio" name="q37" value="B"> B. It ensures that preservation respects living traditions</label><label><input type="radio" name="q37" value="C"> C. It eliminates the threat of urban development</label><label><input type="radio" name="q37" value="D"> D. It makes technological preservation methods unnecessary</label></div></div>
      <div class="question"><div class="qtext">38. What is the main idea of the final paragraph?</div><div class="options"><label><input type="radio" name="q38" value="A"> A. Cultural heritage preservation is primarily about protecting physical objects</label><label><input type="radio" name="q38" value="B"> B. Preservation efforts should prevent cultural expressions from evolving</label><label><input type="radio" name="q38" value="C"> C. Heritage preservation maintains cultural diversity and fosters respect</label><label><input type="radio" name="q38" value="D"> D. International organizations should control all preservation efforts</label></div></div>

      <div class="passage">
        <h3>Passage 2</h3>
        <p>The preference of Taiwanese tourists for Japan as a travel destination represents a fascinating phenomenon in cross-cultural tourism. Statistical data consistently shows that Japan ranks as the most popular international travel destination for Taiwanese citizens, with millions visiting annually. This preference stems from a combination of historical, cultural, practical, and emotional factors that create a unique appeal for Taiwanese travelers.</p>
        <p>Historical connections between Taiwan and Japan have created a foundation for contemporary travel patterns. During the period of Japanese rule (1895-1945), numerous cultural exchanges and infrastructure developments established enduring connections between the two societies. Many older Taiwanese recall this period with a sense of nostalgia, while younger generations have been exposed to Japanese culture through various media channels. This historical background has fostered a sense of familiarity and affinity that makes Japan feel accessible and welcoming to Taiwanese visitors.</p>
        <p>Cultural similarities and differences both contribute to Japan's appeal. Taiwanese travelers often note the comfortable balance between cultural familiarity and exotic novelty when visiting Japan. The shared use of Chinese characters in writing reduces language barriers significantly compared to other foreign destinations. At the same time, Japan's distinct cultural practices, traditional arts, and unique social customs provide enough novelty to satisfy travelers' desires for new experiences. This combination allows Taiwanese visitors to feel both comfortable and stimulated during their travels.</p>
        <p>Practical considerations significantly influence travel decisions. The geographical proximity between Taiwan and Japan makes travel relatively convenient and affordable. With flight times of just three to four hours from major Taiwanese cities to popular Japanese destinations like Tokyo and Osaka, Japan is accessible even for short vacations. Additionally, the well-developed transportation infrastructure within Japan, including its world-renowned rail system, makes internal travel efficient and enjoyable. The availability of diverse accommodation options, from luxury hotels to affordable business hotels and traditional ryokans, caters to various budgets and preferences.</p>
        <p>Safety and cleanliness are frequently cited as important factors in destination selection. Japan's reputation as one of the world's safest countries, with low crime rates and orderly public spaces, provides peace of mind for travelers. The exceptional cleanliness of Japanese cities, efficient public services, and reliable infrastructure contribute to a stress-free travel experience. These qualities are particularly valued by family travelers and those visiting for the first time.</p>
      </div>
      <div class="question"><div class="qtext">39. According to the passage, what historical factor contributes to Taiwanese preference for traveling to Japan?</div><div class="options"><label><input type="radio" name="q39" value="A"> A. Recent political agreements between the two countries</label><label><input type="radio" name="q39" value="B"> B. The period of Japanese rule which established cultural connections</label><label><input type="radio" name="q39" value="C"> C. Ancient trade routes that connected Taiwan and Japan</label><label><input type="radio" name="q39" value="D"> D. Military alliances during World War II</label></div></div>
      <div class="question"><div class="qtext">40. How do cultural factors make Japan appealing to Taiwanese travelers according to the passage?</div><div class="options"><label><input type="radio" name="q40" value="A"> A. Complete cultural similarity eliminates any communication challenges</label><label><input type="radio" name="q40" value="B"> B. Taiwan has completely adopted Japanese cultural practices</label><label><input type="radio" name="q40" value="C"> C. Japanese culture is completely different, providing total cultural immersion</label><label><input type="radio" name="q40" value="D"> D. The balance between familiarity and novelty creates an ideal travel experience</label></div></div>
      <div class="question"><div class="qtext">41. How does geographical proximity fundamentally shape the Taiwan-Japan travel dynamic?</div><div class="options"><label><input type="radio" name="q41" value="A"> A. It transforms Japan from a major trip to an accessible destination</label><label><input type="radio" name="q41" value="B"> B. It eliminates all practical barriers to international travel</label><label><input type="radio" name="q41" value="C"> C. It makes Japan the only feasible foreign destination option</label><label><input type="radio" name="q41" value="D"> D. It reduces the cultural significance of the travel experience</label></div></div>
      <div class="question"><div class="qtext">42. Based on the passage, which factor is particularly important for family travelers when choosing Japan?</div><div class="options"><label><input type="radio" name="q42" value="A"> A. The availability of extreme sports activities</label><label><input type="radio" name="q42" value="B"> B. Japan's reputation for safety and cleanliness</label><label><input type="radio" name="q42" value="C"> C. The complete absence of language barriers</label><label><input type="radio" name="q42" value="D"> D. Free accommodation for children</label></div></div>

      <div class="passage">
        <h3>Passage 3</h3>
        <p>Mental health awareness has undergone significant transformation in recent decades, moving from a topic shrouded in stigma and misunderstanding to an increasingly recognized component of overall well-being. This shift reflects growing understanding that mental health is not merely the absence of mental illness but a state of well-being in which individuals realize their abilities, cope with normal stresses of life, work productively, and contribute to their communities.</p>
        <p>The global burden of mental health conditions is substantial, with depression ranking as a leading cause of disability worldwide. Anxiety disorders, substance abuse, and other mental health conditions affect millions of people across all demographics. Despite this prevalence, many individuals do not receive adequate care due to barriers including stigma, limited access to services, and insufficient mental health literacy. The economic impact of untreated mental health conditions is significant, including lost productivity, increased healthcare costs, and reduced quality of life.</p>
        <p>Destigmatization represents a crucial aspect of improving mental health care. Stigmaâ€”comprising prejudice, discrimination, and negative stereotypesâ€”often prevents people from seeking help and discussing their mental health challenges openly. Public awareness campaigns, celebrity disclosures, and educational programs have helped normalize conversations about mental health and reduce stigma in many societies. However, significant work remains, particularly in cultures where mental health remains a taboo subject.</p>
        <p>The digital revolution has transformed mental health care delivery through telepsychiatry, mental health apps, and online support communities. These technologies increase accessibility, particularly for people in remote areas or those hesitant to seek in-person care. However, questions about the quality, privacy, and effectiveness of digital mental health interventions remain, highlighting the need for regulation and evidence-based standards.</p>
        <p>The COVID-19 pandemic brought mental health concerns to the forefront as lockdowns, social isolation, economic uncertainty, and fear of illness contributed to worsening mental health across populations. This crisis underscored the importance of resilient mental health systems and the need to integrate mental health support into emergency response plans. It also demonstrated how mental health challenges can affect anyone, regardless of previous psychological history.</p>
      </div>
      <div class="question"><div class="qtext">43. According to the passage, what is the current understanding of mental health?</div><div class="options"><label><input type="radio" name="q43" value="A"> A. It is merely the absence of mental illness</label><label><input type="radio" name="q43" value="B"> B. It involves realizing abilities and coping with normal stresses</label><label><input type="radio" name="q43" value="C"> C. It only concerns people with diagnosed conditions</label><label><input type="radio" name="q43" value="D"> D. It is separate from physical health</label></div></div>
      <div class="question"><div class="qtext">44. What is identified as a major barrier to mental health care?</div><div class="options"><label><input type="radio" name="q44" value="A"> A. Overwhelming public support for mental health services</label><label><input type="radio" name="q44" value="B"> B. Complete integration of mental health into primary care</label><label><input type="radio" name="q44" value="C"> C. Excessive availability of mental health professionals</label><label><input type="radio" name="q44" value="D"> D. Stigma preventing people from seeking help</label></div></div>
      <div class="question"><div class="qtext">45. How has digital technology affected mental health care according to the passage?</div><div class="options"><label><input type="radio" name="q45" value="A"> A. It has made mental health care less accessible</label><label><input type="radio" name="q45" value="B"> B. It has replaced all traditional forms of therapy</label><label><input type="radio" name="q45" value="C"> C. It has increased accessibility, especially for remote areas</label><label><input type="radio" name="q45" value="D"> D. It has eliminated the need for regulation in mental health care</label></div></div>
      <div class="question"><div class="qtext">46. What fundamental truth about mental health did the pandemic reveal?</div><div class="options"><label><input type="radio" name="q46" value="A"> A. Mental health vulnerability is universal, not exceptional</label><label><input type="radio" name="q46" value="B"> B. External crises have minimal impact on psychological wellbeing</label><label><input type="radio" name="q46" value="C"> C. Pre-existing conditions determine pandemic mental health outcomes</label><label><input type="radio" name="q46" value="D"> D. Mental health is primarily determined by economic status</label></div></div>
    </div>

    <div class="quiz-section">
      <h2>ç¬¬å…­å¤§é¡Œï¼šè‹±æ–‡ä½œæ–‡ï¼ˆå 20åˆ†ï¼‰</h2>
      <p class="hint">èªªæ˜ï¼šä¾æ“šæç¤ºå¯«ä¸€ç¯‡ç´„ 120 è‡³ 150 å­—çš„çŸ­æ–‡ã€‚</p>
      
      <div class="passage">
        <h3>é¡Œç›®ï¼šDealing with Disappointment</h3>
        <p><strong>Prompt:</strong> Life is full of ups and downs. Think of a time when you felt disappointed because things didn't go as planned (e.g., failing an exam, losing a game, or a cancelled trip). Write an essay describing <strong>what happened</strong>, <strong>how you felt</strong>, and <strong>how you coped with the disappointment</strong>.</p>
      </div>

      <div class="essay-container">
        <textarea id="essayInput" placeholder="è«‹åœ¨æ­¤è¼¸å…¥æ‚¨çš„ä½œæ–‡..."></textarea>
        <div class="word-count">å­—æ•¸çµ±è¨ˆ: <span id="wordCountDisplay">0</span></div>
        <button type="button" class="primary" id="gradeEssayBtn" style="background-color: #7c3aed;">ğŸ¤– AI æ‰¹æ”¹ä½œæ–‡</button>
      </div>

      <div id="aiResult" class="ai-grading-result">
        <h3>AI è©•åˆ†çµæœ</h3>
        <div class="score-grid">
          <div class="score-item">
            <span class="score-label">å…§å®¹ (Content)</span>
            <span class="score-value" id="scoreContent">--</span>
          </div>
          <div class="score-item">
            <span class="score-label">çµ„ç¹” (Organization)</span>
            <span class="score-value" id="scoreOrg">--</span>
          </div>
          <div class="score-item">
            <span class="score-label">æ–‡æ³• (Grammar)</span>
            <span class="score-value" id="scoreGrammar">--</span>
          </div>
          <div class="score-item">
            <span class="score-label">å­—å½™ (Vocabulary)</span>
            <span class="score-value" id="scoreVocab">--</span>
          </div>
        </div>
        <div class="total-score">ç¸½åˆ†ï¼š<span id="scoreTotal">--</span> / 20</div>
        <div style="margin-top: 15px;">
          <strong>è©•èªèˆ‡å»ºè­°ï¼š</strong>
          <p id="aiComments" style="white-space: pre-wrap; color: #333;"></p>
        </div>
      </div>
    </div>

    <div style="margin-top:30px; display:flex; gap:15px; justify-content:center;">
      <button type="button" class="primary" id="submitBtn" style="font-size:1.1rem; padding:12px 24px;">æäº¤é¸æ“‡é¡Œ</button>
      <button type="reset" class="secondary" id="resetFormBtn">é‡åš</button>
    </div>
    <div style="margin-top:15px; text-align:center;">
      <label style="display:inline-block;">
        <input type="checkbox" id="showAnswersCheckbox"> é¡¯ç¤ºæ­£ç¢ºç­”æ¡ˆ
      </label>
      <p style="font-size:0.9rem; color:#555; margin-top:4px;">è«‹æŒ‰ä¸‹æäº¤å¾Œå†é»æ“Š "é¡¯ç¤ºæ­£ç¢ºç­”æ¡ˆ"</p>
    </div>
    <div id="results"></div>

  </form>

  <script>
    // ===== Timer (Countdown) =====
    let countdownInterval = null;
    let remainingSeconds = 0;
    let locked = false;

    function formatTime(sec) {
      const m = Math.floor(sec / 60);
      const s = sec % 60;
      const mm = m.toString().padStart(2,'0');
      const ss = s.toString().padStart(2,'0');
      return `${mm}:${ss}`;
    }

    function updateTimerLabel(prefix) {
      const timer = document.getElementById('timer');
      timer.textContent = `${prefix} ${formatTime(remainingSeconds)}`;
    }

    function lockExam() {
      locked = true;
      document.querySelectorAll('#examForm input, #examForm select, #examForm textarea').forEach(el => el.disabled = true);
      document.getElementById('lockedBanner').style.display = 'block';
    }

    function startCountdown() {
      if (locked) { alert('ç›®å‰å·²é–å®šã€‚è«‹é‡æ–°æ•´ç†é é¢ä»¥é‡æ–°ä½œç­”ã€‚'); return; }
      const minutes = parseInt(document.getElementById('countdownTime').value, 10);
      if (!minutes) return;
      if (!confirm(`å€’æ•¸å°‡å¾ ${minutes} åˆ†é˜é–‹å§‹ï¼Œæ™‚é–“åˆ°æœƒé–å®šä½œç­”ã€‚æ˜¯å¦é–‹å§‹ï¼Ÿ`)) return;

      remainingSeconds = minutes * 60;
      updateTimerLabel('å€’æ•¸å‰©é¤˜');
      document.getElementById('pauseBtn').disabled = false;
      document.getElementById('resetTimerBtn').disabled = false;
      document.getElementById('startBtn').disabled = true;
      document.getElementById('resumeBtn').disabled = true;

      if (countdownInterval) clearInterval(countdownInterval);
      countdownInterval = setInterval(() => {
        remainingSeconds -= 1;
        if (remainingSeconds <= 0) {
          remainingSeconds = 0;
          updateTimerLabel('å€’æ•¸å‰©é¤˜');
          clearInterval(countdownInterval);
          lockExam();
          alert('æ™‚é–“åˆ°ï¼ä½œç­”å·²é–å®šã€‚');
          return;
        }
        updateTimerLabel('å€’æ•¸å‰©é¤˜');
      }, 1000);
    }

    function pauseCountdown() {
      if (!countdownInterval) return;
      clearInterval(countdownInterval);
      countdownInterval = null;
      document.getElementById('pauseBtn').disabled = true;
      document.getElementById('resumeBtn').disabled = false;
    }

    function resumeCountdown() {
      if (countdownInterval || locked) return;
      document.getElementById('pauseBtn').disabled = false;
      document.getElementById('resumeBtn').disabled = true;
      countdownInterval = setInterval(() => {
        remainingSeconds -= 1;
        if (remainingSeconds <= 0) {
          remainingSeconds = 0;
          updateTimerLabel('å€’æ•¸å‰©é¤˜');
          clearInterval(countdownInterval);
          lockExam();
          alert('æ™‚é–“åˆ°ï¼ä½œç­”å·²é–å®šã€‚');
          return;
        }
        updateTimerLabel('å€’æ•¸å‰©é¤˜');
      }, 1000);
    }

    function resetCountdown() {
      if (countdownInterval) clearInterval(countdownInterval);
      countdownInterval = null;
      remainingSeconds = 0;
      document.getElementById('timer').textContent = 'å°šæœªé–‹å§‹';
      document.getElementById('pauseBtn').disabled = true;
      document.getElementById('resumeBtn').disabled = true;
      document.getElementById('resetTimerBtn').disabled = true;
      document.getElementById('startBtn').disabled = false;
    }

    document.getElementById('startBtn').addEventListener('click', startCountdown);
    document.getElementById('pauseBtn').addEventListener('click', pauseCountdown);
    document.getElementById('resumeBtn').addEventListener('click', resumeCountdown);
    document.getElementById('resetTimerBtn').addEventListener('click', resetCountdown);


    // ===== Answer Key =====
    const ANSWERS = {
      // I. Vocabulary
      q1:'A', q2:'B', q3:'B', q4:'C', q5:'C', 
      q6:'A', q7:'C', q8:'D', q9:'D', q10:'B',
      // II. Cloze
      q11:'A', q12:'B', q13:'C', q14:'D', q15:'A',
      q16:'B', q17:'A', q18:'C', q19:'D', q20:'A',
      // III. Contextual Filling
      q21:'G', q22:'A', q23:'C', q24:'B', q25:'D', 
      q26:'E', q27:'F', q28:'J', q29:'H', q30:'I',
      // IV. Discourse Structure
      q31:'C', q32:'A', q33:'D', q34:'B',
      // V. Reading Comprehension
      q35:'C', q36:'B', q37:'B', q38:'C',
      q39:'B', q40:'D', q41:'A', q42:'B',
      q43:'B', q44:'D', q45:'C', q46:'A'
    };


    // ===== Submit & Grade Multiple Choice =====
    function grade() {
      const res = document.getElementById('results');
      res.innerHTML = '';
      let score = 0;
      const total = Object.keys(ANSWERS).length;
      
      for (let i = 1; i <= total; i++) {
        const name = 'q' + i;
        const correct = ANSWERS[name];
        let chosenValue = '';
        const radioEl = document.querySelector(`input[name="${name}"]:checked`);
        const selectEl = document.querySelector(`select[name="${name}"]`);
        
        if (radioEl) chosenValue = radioEl.value;
        else if (selectEl) chosenValue = selectEl.value;

        if (!chosenValue) {
          res.innerHTML += `<p class="wrong">ç¬¬ ${i} é¡Œæœªä½œç­”ï½œæ­£ç¢ºç­”æ¡ˆï¼š<span class="correct-answer">${correct}</span></p>`;
        } else if (chosenValue === correct) {
          score += 1;
          res.innerHTML += `<p class="correct">ç¬¬ ${i} é¡Œç­”å° âœ”</p>`;
        } else {
          res.innerHTML += `<p class="wrong">ç¬¬ ${i} é¡Œç­”éŒ¯ âœ˜ï½œä½ çš„ç­”æ¡ˆï¼š${chosenValue}ï½œæ­£ç¢ºç­”æ¡ˆï¼š<span class="correct-answer">${correct}</span></p>`;
        }
      }
      res.innerHTML += `<h3>é¸æ“‡é¡Œç¸½åˆ†ï¼š${score} / ${total}</h3>`;
      res.scrollIntoView({ behavior: 'smooth' });
    }

    document.getElementById('submitBtn').addEventListener('click', grade);
    document.getElementById('resetFormBtn').addEventListener('click', () => {
      document.getElementById('results').innerHTML = '';
      document.getElementById('aiResult').style.display = 'none';
      document.getElementById('wordCountDisplay').textContent = '0';
    });

    document.getElementById('showAnswersCheckbox').addEventListener('change', function() {
      const show = this.checked;
      document.querySelectorAll('.correct-answer').forEach(el => {
        el.style.display = show ? 'inline' : 'none';
      });
    });


    // ===== Essay & AI Grading (v1 API Fix) =====
    const essayInput = document.getElementById('essayInput');
    const wordCountDisplay = document.getElementById('wordCountDisplay');

    essayInput.addEventListener('input', function() {
      const text = this.value.trim();
      const words = text === '' ? 0 : text.split(/\s+/).length;
      wordCountDisplay.textContent = words;
    });

    document.getElementById('gradeEssayBtn').addEventListener('click', async function() {
      const essayText = essayInput.value.trim();
      const resultDiv = document.getElementById('aiResult');
      const btn = this;

      if (essayText.length < 5) {
        alert("ä½œæ–‡å­—æ•¸å¤ªå°‘ï¼Œè«‹è‡³å°‘å¯«å¹¾å€‹å®Œæ•´çš„å¥å­å†é€²è¡Œæ‰¹æ”¹ã€‚");
        return;
      }

      btn.disabled = true;
      btn.textContent = "è©•åˆ†ä¸­...è«‹ç¨å€™";
      resultDiv.style.display = 'none';

      // =============================================================
      // â˜…â˜…â˜… è¨­å®šå€åŸŸ â˜…â˜…â˜…
      
      const USE_SIMULATION = false; 
      // è«‹å°‡æ‚¨çš„ Key è²¼åœ¨é€™è£¡ (éœ€ä¿ç•™é›™å¼•è™Ÿ)
      let API_KEY = "AIzaSyBtQWojvvcYA2h5e2IPTkoAl8QRBAeok6U"; 

      // æˆ‘å€‘æ”¹ç”¨ v1beta + gemini-1.5-flashï¼Œé€™æ˜¯ç›®å‰æœ€ç©©å®šçš„çµ„åˆ
      // å¦‚æœ 404ï¼Œé€šå¸¸æ˜¯ Google Cloud Console é™åˆ¶å•é¡Œï¼Œè«‹åƒè€ƒä¸Šè¿°èªªæ˜è§£é™¤é™åˆ¶
      const MODEL_NAME = "gemini-1.5-flash";
      
      // =============================================================

      API_KEY = API_KEY.trim(); 

      try {
        let resultData;

        if (USE_SIMULATION) {
          await new Promise(resolve => setTimeout(resolve, 1500));
          resultData = {
            content: 4, organization: 3, grammar: 3, vocab: 4, total: 14,
            comment: "ã€æ¨¡æ“¬è©•èªã€‘é€™æ˜¯æ¸¬è©¦æ¨¡å¼ã€‚"
          };
        } else {
          if (!API_KEY || API_KEY.includes("æ‚¨çš„API_KEY") || API_KEY.includes("åœ¨æ­¤è²¼ä¸Š")) {
             throw new Error("è«‹å…ˆåœ¨ç¨‹å¼ç¢¼ä¸­å¡«å…¥æœ‰æ•ˆçš„ API Keyï¼");
          }
          
          const prompt = `
            You are an English teacher grading a high school essay.
            Task: Grade the essay based on 4 criteria (Content, Organization, Grammar, Vocabulary), 0-5 points each.
            Essay Topic: "Dealing with Disappointment".
            Student Essay: "${essayText.replace(/"/g, '\\"')}"

            IMPORTANT: Return ONLY valid JSON format. Do NOT use markdown code blocks.
            JSON Format:
            {
              "content": number,
              "organization": number,
              "grammar": number,
              "vocab": number,
              "total": number,
              "comment": "Provide detailed constructive feedback in Traditional Chinese (ç¹é«”ä¸­æ–‡)."
            }
          `;

          // ä½¿ç”¨ v1beta æ¥å£
          const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${MODEL_NAME}:generateContent?key=${API_KEY}`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
              contents: [{ parts: [{ text: prompt }] }]
            })
          });

          if (!response.ok) {
            const errData = await response.json().catch(() => ({}));
            // å¦‚æœæ˜¯ 404ï¼Œæç¤ºç”¨æˆ¶å»æª¢æŸ¥ Google Cloud Console é™åˆ¶
            if (response.status === 404) {
               throw new Error(`API Error (404): æ¨¡å‹æ‰¾ä¸åˆ°æˆ–æ¬Šé™ä¸è¶³ã€‚\n\nè«‹å‹™å¿…åˆ° Google Cloud Console æª¢æŸ¥ API Key çš„ã€Œæ‡‰ç”¨ç¨‹å¼é™åˆ¶ã€æ˜¯å¦è¨­ç‚ºã€Œç„¡ (None)ã€ã€‚`);
            }
            throw new Error(`API Error (${response.status}): ${errData.error?.message || response.statusText}`);
          }

          const data = await response.json();
          
          if (!data.candidates || !data.candidates[0] || !data.candidates[0].content) {
             throw new Error("AI é›–ç„¶é€£ç·šæˆåŠŸï¼Œä½†æ²’æœ‰å›å‚³å…§å®¹ (å¯èƒ½è¢«å®‰å…¨æ€§éæ¿¾)ã€‚");
          }

          let rawText = data.candidates[0].content.parts[0].text;
          const jsonStart = rawText.indexOf('{');
          const jsonEnd = rawText.lastIndexOf('}');
          if (jsonStart !== -1 && jsonEnd !== -1) {
            rawText = rawText.substring(jsonStart, jsonEnd + 1);
          }
          
          resultData = JSON.parse(rawText);
        }

        document.getElementById('scoreContent').textContent = resultData.content || 0;
        document.getElementById('scoreOrg').textContent = resultData.organization || 0;
        document.getElementById('scoreGrammar').textContent = resultData.grammar || 0;
        document.getElementById('scoreVocab').textContent = resultData.vocab || 0;
        document.getElementById('scoreTotal').textContent = resultData.total || 0;
        document.getElementById('aiComments').textContent = resultData.comment || "ç„¡è©•èª";

        resultDiv.style.display = 'block';

      } catch (error) {
        console.error("Grading Error:", error);
        alert(`æ‰¹æ”¹ç™¼ç”ŸéŒ¯èª¤ï¼š\n${error.message}`);
      } finally {
        btn.disabled = false;
        btn.textContent = "ğŸ¤– AI æ‰¹æ”¹ä½œæ–‡";
      }
    });
</script>
</body>
</html>