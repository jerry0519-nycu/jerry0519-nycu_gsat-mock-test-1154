<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>115學測英文模擬試題(四)</title>
  <style>
    /* === 全局設定 === */
    body { 
      font-family: "Noto Sans TC", "Microsoft JhengHei", Arial, sans-serif; 
      margin: 0; 
      padding-top: 60px; /* 預留一點空間給收合後的按鈕 */
      line-height: 1.6; 
      background-color: #f4f4f4; 
      color: #333; 
    }
    h1, h2, h3 { color: #2c3e50; }
    h1 { text-align: center; margin-bottom: 30px; }
    h2 { margin-top: 0; border-bottom: 2px solid #2c3e50; padding-bottom: 10px; margin-bottom: 20px;}
    
    /* =========================================
       1. 置頂計分板 (Score Dashboard) - 深色背景
       ========================================= */
    #score-dashboard {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      background: #2c3e50;
      color: white;
      z-index: 1000; /* 最高層級 */
      padding: 10px 20px 15px 20px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.2);
      display: flex;
      flex-direction: column;
      gap: 5px;
      transition: transform 0.3s ease-in-out;
    }
    
    #score-dashboard.collapsed {
      transform: translateY(-100%);
    }

    .dashboard-row {
      display: flex;
      justify-content: center;
      gap: 15px;
      flex-wrap: wrap;
      font-size: 0.9rem;
    }
    .dashboard-item {
      background: rgba(255,255,255,0.1);
      padding: 4px 10px;
      border-radius: 4px;
      white-space: nowrap;
    }
    .dashboard-total {
      font-size: 1.3rem;
      font-weight: bold;
      color: #fbbf24;
      background: rgba(255,255,255,0.2);
    }
    .score-val { font-weight: bold; color: #a5f3fc; margin-left: 5px; }

    /* 計分板按鈕 (中央) */
    #dashboard-toggle-btn {
      position: absolute;
      bottom: -32px;
      left: 50%;
      transform: translateX(-50%);
      background-color: #2c3e50;
      color: #fbbf24;
      border: none;
      border-radius: 0 0 10px 10px;
      padding: 5px 20px;
      cursor: pointer;
      font-weight: bold;
      box-shadow: 0 4px 4px rgba(0,0,0,0.15);
      z-index: 1001;
      transition: background-color 0.2s;
    }
    #dashboard-toggle-btn:hover { background-color: #34495e; }

    /* =========================================
       2. 計時器面板 (Timer Bar) - 白色背景
       ========================================= */
    #timer-bar {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      background: #fff;
      border-bottom: 1px solid #ddd;
      z-index: 900; /* 次高層級，被計分板蓋住 */
      padding: 10px 20px 15px 20px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      align-items: center;
      justify-content: space-between;
      transition: transform 0.3s ease-in-out;
      box-sizing: border-box; /* 確保 padding 不會撐爆寬度 */
    }

    #timer-bar.collapsed {
      transform: translateY(-100%);
    }

    .timer-left-group {
      display: flex;
      gap: 10px;
      align-items: center;
      flex-wrap: wrap;
    }

    .timer-right-group {
      display: flex;
      gap: 10px;
      align-items: center;
    }

    #timer { 
      font-weight: bold; 
      color: #d35400; 
      font-size: 1.4rem;
      min-width: 80px;
      text-align: right;
    }

    /* 計時器按鈕 (右側懸掛) */
    #timer-toggle-btn {
      position: absolute;
      bottom: -32px;
      right: 40px; /* 靠右，避開中央的計分板按鈕 */
      background-color: #fff;
      color: #2563eb;
      border: 1px solid #ddd;
      border-top: none;
      border-radius: 0 0 8px 8px;
      padding: 5px 15px;
      cursor: pointer;
      font-weight: bold;
      box-shadow: 0 4px 4px rgba(0,0,0,0.05);
      z-index: 901;
      transition: background-color 0.2s;
    }
    #timer-toggle-btn:hover { background-color: #f0f9ff; }


    /* === 試卷區塊樣式 === */
    .container-body { margin: 20px; margin-top: 40px; }

    .quiz-section { background: #fff; margin-top: 30px; padding: 30px; border: 1px solid #ddd; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); }
    .question { margin-bottom: 20px; padding-bottom: 15px; border-bottom: 1px solid #eee; }
    .question:last-child { border-bottom: none; }
    .qtext { font-weight: bold; margin-bottom: 8px; font-size: 1.05rem; }
    
    .cloze-passage, .passage { background: #f8fbfd; padding: 20px 25px; border-left: 5px solid #2980b9; margin-bottom: 25px; line-height: 1.9; text-align: justify; border-radius: 4px; font-size: 1.05rem; }
    .group-title { font-weight: bold; color: #e67e22; margin-top: 30px; margin-bottom: 15px; font-size: 1.2em; border-bottom: 2px solid #e67e22; display: inline-block; }

    label { display: block; margin-left: 15px; margin-top: 5px; cursor: pointer; transition: background 0.2s; padding: 4px 8px; border-radius: 4px; }
    label:hover { background-color: #f0f0f0; }
    select { margin-left: 5px; padding: 5px; border-radius: 4px; border: 1px solid #ccc; font-size: 1rem;}
    
    button { padding: 10px 18px; font-size: 15px; cursor: pointer; border-radius: 6px; border: none; transition: all 0.3s; font-weight: bold; }
    .primary { background: #2563eb; color: white; }
    .primary:hover { background: #1d4ed8; }
    .secondary { background: #e5e7eb; color: #111; }
    .secondary:hover { background: #d1d5db; }
    .danger { background: #dc2626; color: white; }
    .danger:hover { background: #b91c1c; }
    button:disabled { opacity: 0.6; cursor: not-allowed; }

    .correct-answer { display: none; color: #16a34a; font-weight: bold; margin-left: 10px; background: #e8f5e9; padding: 2px 5px; border-radius: 3px;}
    .wrong { color: #dc2626; }
    .correct { color: #16a34a; font-weight: bold; }
    #results { margin-top: 20px; padding: 20px; border: 2px solid #ddd; border-radius: 10px; background: #fff;}
    .locked-banner { display: none; padding: 15px; background: #fff3cd; color: #856404; border: 1px solid #ffeeba; border-radius: 8px; margin-bottom: 20px; text-align: center; font-weight: bold; font-size: 1.2rem; }

    /* 作文區塊 */
    .essay-container { display: flex; flex-direction: column; gap: 10px; }
    textarea#essayInput { width: 100%; height: 400px; padding: 15px; border: 1px solid #ccc; border-radius: 8px; font-family: 'Times New Roman', serif; font-size: 18px; line-height: 1.6; resize: vertical; box-sizing: border-box; }
    .word-count { text-align: right; font-size: 0.9rem; color: #666; }
    .ai-grading-result { margin-top: 15px; padding: 20px; background-color: #f0fdf4; border: 1px solid #bbf7d0; border-radius: 8px; display: none; }
    .score-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 10px; margin-bottom: 15px; }
    .score-item { background: white; padding: 10px; border-radius: 6px; text-align: center; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
    .score-label { font-size: 0.85rem; color: #555; display: block; }
    .score-value { font-size: 1.5rem; font-weight: bold; color: #16a34a; }
    .total-score { font-size: 1.3rem; font-weight: bold; border-top: 2px solid #eee; padding-top: 15px; margin-top: 10px; text-align: center; color: #2c3e50;}

    /* 雙色訂正 */
    details.correction-dropdown { background-color: #fff; border: 1px solid #d1d5db; border-radius: 8px; margin-bottom: 20px; overflow: hidden; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
    details.correction-dropdown summary { padding: 15px 20px; background-color: #f3f4f6; font-weight: bold; color: #374151; cursor: pointer; list-style: none; display: flex; justify-content: space-between; align-items: center; }
    details.correction-dropdown summary::after { content: '▼'; font-size: 0.8em; transition: 0.2s; }
    details.correction-dropdown[open] summary::after { transform: rotate(180deg); }
    .essay-correction-content { padding: 25px; line-height: 2.6; font-family: "Times New Roman", "Noto Sans TC", serif; font-size: 1.2rem; color: #1f2937; }
    .mark-error { color: #dc2626; text-decoration: underline wavy #dc2626; text-decoration-thickness: 1.5px; font-weight: bold; cursor: help; position: relative; margin: 0 3px; background-color: rgba(254, 226, 226, 0.5); padding: 0 2px; border-radius: 3px; }
    .mark-opt { color: #2563eb; text-decoration: underline dotted #2563eb; text-decoration-thickness: 2px; font-weight: bold; cursor: help; position: relative; margin: 0 3px; background-color: rgba(219, 234, 254, 0.5); padding: 0 2px; border-radius: 3px; }
    .mark-error::before, .mark-opt::before { content: attr(data-suggestion); position: absolute; bottom: 130%; left: 50%; transform: translateX(-50%); padding: 6px 12px; border-radius: 6px; font-size: 0.95rem; font-family: Arial, sans-serif; white-space: pre; opacity: 0; pointer-events: none; transition: opacity 0.2s, bottom 0.2s; z-index: 100; box-shadow: 0 4px 10px rgba(0,0,0,0.15); font-weight: normal; min-width: 120px; text-align: center; }
    .mark-error::before { background-color: #991b1b; color: white; border: 1px solid #7f1d1d; }
    .mark-opt::before { background-color: #1e40af; color: white; border: 1px solid #1e3a8a; }
    .mark-error::after, .mark-opt::after { content: ''; position: absolute; bottom: 120%; left: 50%; margin-left: -6px; border-width: 6px; border-style: solid; opacity: 0; transition: opacity 0.2s; }
    .mark-error::after { border-color: #991b1b transparent transparent transparent; }
    .mark-opt::after { border-color: #1e40af transparent transparent transparent; }
    .mark-error:hover::before, .mark-error:hover::after, .mark-opt:hover::before, .mark-opt:hover::after { opacity: 1; bottom: 125%; }

    .feedback-box { margin-top: 20px; padding: 20px; background: #fff; border-left: 5px solid #2563eb; border-radius: 4px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
    .feedback-title { font-weight: bold; color: #1e40af; margin-bottom: 10px; display: block; font-size: 1.15rem; border-bottom: 1px solid #e5e7eb; padding-bottom: 8px; }
    .feedback-content { white-space: pre-wrap; color: #374151; line-height: 1.8; font-size: 1.05rem; text-align: justify; }
    .legend-box { font-size: 0.9rem; margin-bottom: 0; padding: 5px 10px; background: #fff; border:1px solid #ddd; border-radius: 4px; display: inline-flex; align-items: center; }
    .legend-dot { display: inline-block; width: 12px; height: 12px; border-radius: 50%; margin-right: 5px; }
    .ai-loading-anim { display: inline-block; animation: blink 1.5s infinite; }
    @keyframes blink { 0% { opacity: 0.2; } 50% { opacity: 1; } 100% { opacity: 0.2; } }

    /* 混合題與翻譯 */
    .mixed-table { width: 100%; border-collapse: collapse; margin: 15px 0; background: #fff; }
    .mixed-table th, .mixed-table td { border: 1px solid #ccc; padding: 10px; text-align: left; vertical-align: top; }
    .mixed-table th { background: #e0e7ff; color: #333; width: 30%; }
    .mixed-input { border: none; border-bottom: 2px solid #333; background: #fdfdfd; padding: 2px 5px; font-size: 1rem; width: 80%; outline: none; color: #166534; font-weight: bold; }
    .mixed-input:focus { border-bottom-color: #2563eb; background: #eef2ff; }
    .q50-container { display: flex; gap: 15px; flex-wrap: wrap; margin-top: 10px; }
    .q50-item { flex: 1; min-width: 200px; }
    .q50-input { width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px; font-size: 1rem; }
    textarea.trans-input { width: 100%; height: 80px; padding: 10px; border: 1px solid #ccc; border-radius: 6px; font-size: 1rem; font-family: 'Times New Roman', serif; resize: vertical; margin-bottom: 10px; }
    .translation-result-box { margin-top: 15px; padding: 15px; background: #fafafa; border: 1px solid #eee; border-radius: 8px; }
    .trans-feedback { color: #666; font-size: 0.95rem; margin-top: 5px; font-style: italic; }
  </style>
</head>
<body>

  <div id="score-dashboard" class="collapsed">
    <div style="text-align: center; font-size: 1.1rem; margin-bottom: 5px; font-weight: bold; border-bottom: 1px solid rgba(255,255,255,0.3); padding-bottom: 5px;">
      即時成績看板 (Real-time Scoreboard)
    </div>
    <div class="dashboard-row">
      <div class="dashboard-item">詞彙: <span id="dash-vocab" class="score-val">0</span></div>
      <div class="dashboard-item">綜合: <span id="dash-cloze" class="score-val">0</span></div>
      <div class="dashboard-item">文意: <span id="dash-context" class="score-val">0</span></div>
      <div class="dashboard-item">篇章: <span id="dash-struct" class="score-val">0</span></div>
      <div class="dashboard-item">閱讀: <span id="dash-reading" class="score-val">0</span></div>
      <div class="dashboard-item">混合: <span id="dash-mixed" class="score-val">0</span></div>
    </div>
    <div class="dashboard-row">
      <div class="dashboard-item">中譯英: <span id="dash-trans" class="score-val">--</span></div>
      <div class="dashboard-item">作文: <span id="dash-essay" class="score-val">--</span></div>
      <div class="dashboard-item dashboard-total">目前總分: <span id="dash-total" class="score-val">0</span> / 100</div>
    </div>
    <button id="dashboard-toggle-btn" type="button">⬇ 顯示成績</button>
  </div>

  <div id="timer-bar" class="collapsed"> <div class="timer-left-group">
      <label for="countdownTime" style="margin:0; font-weight:bold;">時間設定：</label>
      <select id="countdownTime">
        <option value="30">30 分鐘</option>
        <option value="45">45 分鐘</option>
        <option value="60" selected>60 分鐘</option>
        <option value="75">75 分鐘</option>
        <option value="90">90 分鐘</option>
        <option value="105">100 分鐘</option>
      </select>
      <button class="primary" id="startBtn" type="button">開始</button>
      <button class="secondary" id="pauseBtn" type="button" disabled>暫停</button>
      <button class="secondary" id="resumeBtn" type="button" disabled>繼續</button>
      <button class="danger" id="resetTimerBtn" type="button" disabled>重設</button>
    </div>

    <div class="timer-right-group">
      <span style="font-size:0.9rem; color:#666;">剩餘：</span>
      <span id="timer">尚未開始</span>
    </div>

    <button id="timer-toggle-btn" type="button">⏱ 顯示計時器</button>
  </div>

  <div class="container-body">
    <h1>115學測英文模擬試題(四)</h1>
    
    <div id="lockedBanner" class="locked-banner">⚠️ 時間到！所有作答欄位已鎖定。</div>

    <form id="examForm">
      <div class="quiz-section">
        <h2>第一大題：詞彙測驗（1–10 題，每題1分）</h2>
        <div class="question"><div class="qtext">1. She was ______ to tell the truth because she didn't want to hurt her friend's feelings, so she kept quiet.</div><div class="options"><label><input type="radio" name="q1" value="A"> A. reluctant</label><label><input type="radio" name="q1" value="B"> B. efficient</label><label><input type="radio" name="q1" value="C"> C. innocent</label><label><input type="radio" name="q1" value="D"> D. magnificent</label></div></div>
        <div class="question"><div class="qtext">2. The loud explosion seemed to ______ the birds in the park, causing them to fly away in panic.</div><div class="options"><label><input type="radio" name="q2" value="A"> A. delight</label><label><input type="radio" name="q2" value="B"> B. frighten</label><label><input type="radio" name="q2" value="C"> C. comfort</label><label><input type="radio" name="q2" value="D"> D. admire</label></div></div>
        <div class="question"><div class="qtext">3. This restaurant has an excellent ______ for serving the most authentic Italian food in the city.</div><div class="options"><label><input type="radio" name="q3" value="A"> A. calculation</label><label><input type="radio" name="q3" value="B"> B. reputation</label><label><input type="radio" name="q3" value="C"> C. population</label><label><input type="radio" name="q3" value="D"> D. transportation</label></div></div>
        <div class="question"><div class="qtext">4. The organizers ______ a huge crowd at the outdoor concert because the weather forecast is perfect.</div><div class="options"><label><input type="radio" name="q4" value="A"> A. participate</label><label><input type="radio" name="q4" value="B"> B. demonstrate</label><label><input type="radio" name="q4" value="C"> C. anticipate</label><label><input type="radio" name="q4" value="D"> D. investigate</label></div></div>
        <div class="question"><div class="qtext">5. Please handle these wine glasses with care; they are extremely ______ and can break easily.</div><div class="options"><label><input type="radio" name="q5" value="A"> A. accurate</label><label><input type="radio" name="q5" value="B"> B. desperate</label><label><input type="radio" name="q5" value="C"> C. delicate</label><label><input type="radio" name="q5" value="D"> D. immediate</label></div></div>
        <div class="question"><div class="qtext">6. The author made a subtle ______ to Greek mythology in her novel, which only educated readers would notice.</div><div class="options"><label><input type="radio" name="q6" value="A"> A. allusion</label><label><input type="radio" name="q6" value="B"> B. illusion</label><label><input type="radio" name="q6" value="C"> C. dimension</label><label><input type="radio" name="q6" value="D"> D. expansion</label></div></div>
        <div class="question"><div class="qtext">7. The spicy sauce serves as a perfect ______ to the grilled chicken, enhancing its flavor significantly.</div><div class="options"><label><input type="radio" name="q7" value="A"> A. replacement</label><label><input type="radio" name="q7" value="B"> B. compliment</label><label><input type="radio" name="q7" value="C"> C. complement</label><label><input type="radio" name="q7" value="D"> D. requirement</label></div></div>
        <div class="question"><div class="qtext">8. According to the schedule, a brief opening speech will ______ the awards ceremony.</div><div class="options"><label><input type="radio" name="q8" value="A"> A. proceed</label><label><input type="radio" name="q8" value="B"> B. persuade</label><label><input type="radio" name="q8" value="C"> C. provide</label><label><input type="radio" name="q8" value="D"> D. precede</label></div></div>
        <div class="question"><div class="qtext">9. Despite the scandal, the politician managed to ______ the storm and win the re-election.</div><div class="options"><label><input type="radio" name="q9" value="A"> A. fracture</label><label><input type="radio" name="q9" value="B"> B. dissolve</label><label><input type="radio" name="q9" value="C"> C. scatter</label><label><input type="radio" name="q9" value="D"> D. weather</label></div></div>
        <div class="question"><div class="qtext">10. The accountant was fired after he was caught trying to ______ the financial reports to hide the losses.</div><div class="options"><label><input type="radio" name="q10" value="A"> A. monitor</label><label><input type="radio" name="q10" value="B"> B. doctor</label><label><input type="radio" name="q10" value="C"> C. tutor</label><label><input type="radio" name="q10" value="D"> D. sponsor</label></div></div>
      </div>

      <div class="quiz-section">
        <h2>第二大題：綜合測驗（11–20 題，每題1分）</h2>
        <div class="group-title">題組 A（11–15 題）</div>
        <div class="passage"><p>Water scarcity has undoubtedly become one of the most pressing environmental challenges of the 21st century. As global temperatures rise, climate change has severely disrupted global weather patterns, (11) _____ prolonged droughts and unpredictable rainfall in many regions. Consequently, reservoirs play a more critical role than ever in stabilizing our water supply. These essential man-made lakes collect rainwater during wet seasons, ensuring that there is enough water (12) _____ for agricultural, industrial, and domestic use during dry spells.</p><p>However, the system is fragile. When reservoir levels drop dangerously low due to a distinct lack of rain, the consequences can be severe. Governments may be forced to implement strict rationing measures, and the sheer (13) _____ of the situation often catches the public off guard. To prevent a total collapse of the water supply system, immediate action is required from everyone. We must adopt more sustainable habits and fix leaking pipes immediately. It is imperative that we value every drop before we eventually (14) _____ this precious resource. Otherwise, our future generations will be forced to (15) _____ the devastating consequences of our negligence.</p></div>
        <div class="question"><div class="qtext">11.</div><div class="options"><label><input type="radio" name="q11" value="A"> A. causing</label><label><input type="radio" name="q11" value="B"> B. caused</label><label><input type="radio" name="q11" value="C"> C. to cause</label><label><input type="radio" name="q11" value="D"> D. cause</label></div></div>
        <div class="question"><div class="qtext">12.</div><div class="options"><label><input type="radio" name="q12" value="A"> A. stores</label><label><input type="radio" name="q12" value="B"> B. stored</label><label><input type="radio" name="q12" value="C"> C. storing</label><label><input type="radio" name="q12" value="D"> D. to store</label></div></div>
        <div class="question"><div class="qtext">13.</div><div class="options"><label><input type="radio" name="q13" value="A"> A. capacity</label><label><input type="radio" name="q13" value="B"> B. identity</label><label><input type="radio" name="q13" value="C"> C. severity</label><label><input type="radio" name="q13" value="D"> D. variety</label></div></div>
        <div class="question"><div class="qtext">14.</div><div class="options"><label><input type="radio" name="q14" value="A"> A. come down with</label><label><input type="radio" name="q14" value="B"> B. look up to</label><label><input type="radio" name="q14" value="C"> C. get rid of</label><label><input type="radio" name="q14" value="D"> D. run out of</label></div></div>
        <div class="question"><div class="qtext">15.</div><div class="options"><label><input type="radio" name="q15" value="A"> A. bear</label><label><input type="radio" name="q15" value="B"> B. charge</label><label><input type="radio" name="q15" value="C"> C. defeat</label><label><input type="radio" name="q15" value="D"> D. occupy</label></div></div>

        <div class="group-title">題組 B（16–20 題）</div>
        <div class="passage"><p>Honeybees may be small insects, but they carry a huge responsibility on their tiny wings. As the world's most important pollinators, bees are responsible for pollinating about one-third of the food we eat, boosting agricultural economies worldwide. (16) _____, in recent years, bee populations have been declining at an alarming rate—a troubling phenomenon known as Colony Collapse Disorder. Scientists have identified several factors contributing to this crisis, including the heavy use of pesticides, massive habitat loss, and climate change.</p><p>The potential (17) _____ of bees poses a serious threat to global food security. Without them, many crops, such as apples, almonds, and broccoli, would struggle to reproduce. Another major issue complicating the situation is the spread of diseases and parasites (18) _____ weaken the hives from within. To reverse this trend, conservationists are urging farmers to reduce chemical usage and plant more wildflowers. It is (19) _____ for us to protect these hardworking insects before it is too late. If the bees disappear completely, the ecosystem will suffer (20) _____ damage that cannot be easily repaired.</p></div>
        <div class="question"><div class="qtext">16.</div><div class="options"><label><input type="radio" name="q16" value="A"> A. Furthermore</label><label><input type="radio" name="q16" value="B"> B. However</label><label><input type="radio" name="q16" value="C"> C. Therefore</label><label><input type="radio" name="q16" value="D"> D. Otherwise</label></div></div>
        <div class="question"><div class="qtext">17.</div><div class="options"><label><input type="radio" name="q17" value="A"> A. disappearance</label><label><input type="radio" name="q17" value="B"> B. maintenance</label><label><input type="radio" name="q17" value="C"> C. assistance</label><label><input type="radio" name="q17" value="D"> D. performance</label></div></div>
        <div class="question"><div class="qtext">18.</div><div class="options"><label><input type="radio" name="q18" value="A"> A. what</label><label><input type="radio" name="q18" value="B"> B. where</label><label><input type="radio" name="q18" value="C"> C. that</label><label><input type="radio" name="q18" value="D"> D. whose</label></div></div>
        <div class="question"><div class="qtext">19.</div><div class="options"><label><input type="radio" name="q19" value="A"> A. artificial</label><label><input type="radio" name="q19" value="B"> B. optional</label><label><input type="radio" name="q19" value="C"> C. reluctant</label><label><input type="radio" name="q19" value="D"> D. vital</label></div></div>
        <div class="question"><div class="qtext">20.</div><div class="options"><label><input type="radio" name="q20" value="A"> A. permanent</label><label><input type="radio" name="q20" value="B"> B. energetic</label><label><input type="radio" name="q20" value="C"> C. temporary</label><label><input type="radio" name="q20" value="D"> D. intimate</label></div></div>
      </div>

      <div class="quiz-section">
        <h2>第三大題：文意選填（21–30 題，每題1分）</h2>
        <div class="passage"><p>Self-defense is often misconstrued as merely combat training, but its core philosophy is actually to ensure that conflicts do not (21) _____ into violence. True defense begins with situational awareness, which entails remaining vigilant about one’s immediate (22) _____ and identifying irregularities early. By avoiding high-risk scenarios, individuals can often resolve issues without having to (23) _____ physical force. Furthermore, projecting a confident demeanor through body language can serve to (24) _____ potential predators, who typically seek easy, unaware targets.</p><p>Should a physical assault become (25) _____, the primary objective shifts instantly from de-escalation to escape. Effective defense does not require brute strength but rather the strategic targeting of (26) _____ points on an aggressor’s body, such as the eyes or throat. In high-stress situations where fine motor skills degrade, it is unwise to attempt to (27) _____ complex martial arts maneuvers. Instead, simple and (28) _____ actions are most likely to create an opening for safety. Using one’s voice to shout commands can also shock the attacker and attract attention.</p><p>Ultimately, mindset dictates survival. Fear is a natural reaction, but training allows individuals to channel that fear into focused action. Preserving one’s life must remain the (29) _____ concern, far outweighing the protection of material possessions or ego. Finally, learning to trust one’s (30) _____ is crucial; if a situation feels ominous, it usually is. Recognizing these subconscious warning signs is often the most powerful tool in personal safety.</p></div>
        <div class="passage"><p><strong>選項：</strong> (A) vicinity　(B) dissuade　(C) resort to　(D) inevitable　(E) vital　(F) execute　(G) escalate　(H) paramount　(I) instincts　(J) decisive</p>
          <div class="question-row" style="display: flex; gap: 20px; margin-bottom: 10px; flex-wrap: wrap;">
            <div class="question"><div class="qtext">21.</div><select name="q21"><option value="">--</option><option value="A">A</option><option value="B">B</option><option value="C">C</option><option value="D">D</option><option value="E">E</option><option value="F">F</option><option value="G">G</option><option value="H">H</option><option value="I">I</option><option value="J">J</option></select></div>
            <div class="question"><div class="qtext">22.</div><select name="q22"><option value="">--</option><option value="A">A</option><option value="B">B</option><option value="C">C</option><option value="D">D</option><option value="E">E</option><option value="F">F</option><option value="G">G</option><option value="H">H</option><option value="I">I</option><option value="J">J</option></select></div>
            <div class="question"><div class="qtext">23.</div><select name="q23"><option value="">--</option><option value="A">A</option><option value="B">B</option><option value="C">C</option><option value="D">D</option><option value="E">E</option><option value="F">F</option><option value="G">G</option><option value="H">H</option><option value="I">I</option><option value="J">J</option></select></div>
            <div class="question"><div class="qtext">24.</div><select name="q24"><option value="">--</option><option value="A">A</option><option value="B">B</option><option value="C">C</option><option value="D">D</option><option value="E">E</option><option value="F">F</option><option value="G">G</option><option value="H">H</option><option value="I">I</option><option value="J">J</option></select></div>
            <div class="question"><div class="qtext">25.</div><select name="q25"><option value="">--</option><option value="A">A</option><option value="B">B</option><option value="C">C</option><option value="D">D</option><option value="E">E</option><option value="F">F</option><option value="G">G</option><option value="H">H</option><option value="I">I</option><option value="J">J</option></select></div>
          </div>
          <div class="question-row" style="display: flex; gap: 20px; margin-bottom: 10px; flex-wrap: wrap;">
            <div class="question"><div class="qtext">26.</div><select name="q26"><option value="">--</option><option value="A">A</option><option value="B">B</option><option value="C">C</option><option value="D">D</option><option value="E">E</option><option value="F">F</option><option value="G">G</option><option value="H">H</option><option value="I">I</option><option value="J">J</option></select></div>
            <div class="question"><div class="qtext">27.</div><select name="q27"><option value="">--</option><option value="A">A</option><option value="B">B</option><option value="C">C</option><option value="D">D</option><option value="E">E</option><option value="F">F</option><option value="G">G</option><option value="H">H</option><option value="I">I</option><option value="J">J</option></select></div>
            <div class="question"><div class="qtext">28.</div><select name="q28"><option value="">--</option><option value="A">A</option><option value="B">B</option><option value="C">C</option><option value="D">D</option><option value="E">E</option><option value="F">F</option><option value="G">G</option><option value="H">H</option><option value="I">I</option><option value="J">J</option></select></div>
            <div class="question"><div class="qtext">29.</div><select name="q29"><option value="">--</option><option value="A">A</option><option value="B">B</option><option value="C">C</option><option value="D">D</option><option value="E">E</option><option value="F">F</option><option value="G">G</option><option value="H">H</option><option value="I">I</option><option value="J">J</option></select></div>
            <div class="question"><div class="qtext">30.</div><select name="q30"><option value="">--</option><option value="A">A</option><option value="B">B</option><option value="C">C</option><option value="D">D</option><option value="E">E</option><option value="F">F</option><option value="G">G</option><option value="H">H</option><option value="I">I</option><option value="J">J</option></select></div>
          </div>
        </div>
      </div>

      <div class="quiz-section">
        <h2>第四大題：篇章結構（31–34 題，每題2分）</h2>
        <div class="passage">
          <p>The landscape of social media is fundamentally shifting from a space for harmless sharing to a breeding ground for high-tech deception, largely driven by the terrifyingly rapid advancement of generative artificial intelligence. In the past, creating realistic special effects required Hollywood-level budgets and technical expertise, but today, "deepfake" technology has effectively democratized the creation of synthetic media, putting powerful tools into the hands of anyone with a smartphone. 31_____ Criminals and scammers now routinely utilize these accessible tools to create incredibly convincing videos of famous celebrities endorsing fake investment schemes or even impersonate specific family members in distress to solicit emergency funds from terrified relatives. 32_____ The seamless and hyper-realistic nature of these fabrications makes them nearly impossible for the average user to distinguish from reality, inevitably leading to significant financial losses and profound emotional distress for countless victims worldwide.</p>
          <p>Combatting this expanding digital epidemic has proven to be an exceedingly difficult uphill battle for both tech giants and government regulators. Social media platforms struggle desperately to filter out malicious content because the generative technology used to create fakes is evolving at a pace that far outstrips the defensive technology used to detect them. 33_____ While some responsible companies attempt to implement digital watermarks or visible labels for AI-generated content, malicious actors often operate on the dark web where rules are ignored, or they find sophisticated ways to strip these indicators before publication. Furthermore, the legal framework for prosecuting these digital crimes remains woefully inadequate, as digital borders are porous and jurisdiction is often unclear. 34_____ As technology continues to accelerate beyond the reach of current regulation, the digital world is fast becoming a hall of mirrors where truth is increasingly difficult to verify, leaving modern society with a profound and persistent dilemma that seems to have no immediate cure.</p>
        </div>
        <div class="passage">
          <p><strong>選項：</strong></p>
          <p>(A) By exploiting the deep trust viewers instinctively place in these familiar faces, criminals manage to generate massive illicit profits.</p>
          <p>(B) Consequently, this never-ending technological cat-and-mouse game suggests that the threat will persist for the foreseeable future.</p>
          <p>(C) These sophisticated algorithms can synthesize audio and video that mimic real people with terrifying accuracy.</p>
          <p>(D) However, as soon as detection software is updated to catch new fakes, scammers simply tweak their algorithms to bypass it.</p>
          <p>(E) Fortunately, strict new international laws have successfully stopped the spread of all AI-generated misinformation on major platforms.</p>
          <div class="question-row" style="display: flex; gap: 20px; align-items: flex-start; flex-wrap: wrap;">
            <div class="question"><div class="qtext">31.</div><select name="q31"><option value="">--</option><option value="A">A</option><option value="B">B</option><option value="C">C</option><option value="D">D</option><option value="E">E</option></select></div>
            <div class="question"><div class="qtext">32.</div><select name="q32"><option value="">--</option><option value="A">A</option><option value="B">B</option><option value="C">C</option><option value="D">D</option><option value="E">E</option></select></div>
            <div class="question"><div class="qtext">33.</div><select name="q33"><option value="">--</option><option value="A">A</option><option value="B">B</option><option value="C">C</option><option value="D">D</option><option value="E">E</option></select></div>
            <div class="question"><div class="qtext">34.</div><select name="q34"><option value="">--</option><option value="A">A</option><option value="B">B</option><option value="C">C</option><option value="D">D</option><option value="E">E</option></select></div>
          </div>
        </div>
      </div>

      <div class="quiz-section">
        <h2>第五大題：閱讀測驗（35–46 題，每題2分）</h2>
        
        <div class="passage">
          <h3>Passage 1</h3>
          <p>The phenomenon of wildfire is one of nature's most primal and destructive forces, yet its behavior is governed by a set of consistent physical principles. For decades, fire science relied on the "Fire Triangle"—heat, fuel, and oxygen—to explain combustion. However, modern pyrology has expanded this concept into the "Fire Tetrahedron," adding a fourth critical element: the uninhibited chemical chain reaction. While this theoretical framework explains how a fire ignites, understanding how a fire <em>moves</em> across a landscape requires analyzing the complex interplay of three macro-factors: Fuel, Weather, and Topography. Among these, topography is often the most decisive factor in determining the speed and direction of a blaze, yet it is also the most frequently underestimated by civilians during evacuation.</p>
          <p>Topography influences fire behavior primarily through slope and terrain shape. It is a fundamental rule of fire physics that flames travel significantly faster uphill than downhill. This acceleration occurs because the flames on a slope lean closer to the ground ahead of them, effectively preheating the unburned vegetation (fuel) through radiation and convection before the fire front even arrives. Consequently, a fire on a steep 30-degree slope can spread up to four times faster than on flat ground. This relationship between slope and velocity turns mountainous terrain into a potential death trap, particularly when combined with specific geological features like narrow canyons or V-shaped valleys.</p>
          <p>This brings us to one of the most dangerous phenomena in wildfire dynamics: the "Chimney Effect." In a steep, narrow canyon, the topography acts literally like a chimney in a fireplace. As the fire burns at the bottom, it heats the air, which then rises rapidly due to its lower density. This rising column of hot air creates a powerful updraft, sucking in fresh oxygen from the bottom of the canyon to feed the flames. This localized wind system can accelerate the fire to explosive speeds, driving it up the canyon walls faster than a human can run. Furthermore, the wind within the canyon is channeled and compressed, increasing its velocity and intensity. Under these conditions, the fire does not just burn; it roars, creating its own weather system that can defy general prevailing wind forecasts.</p>
          <p>Another critical mechanism of spread is "Spotting." This occurs when strong convection columns loft burning embers—pieces of bark, pinecones, or leaves—high into the air. These embers are carried by the wind ahead of the main fire front, landing in unburned fuel and igniting new "spot fires." In extreme conditions, spotting can jump natural barriers like rivers or highways, rendering traditional containment lines useless. This unpredictability necessitates a shift in defensive strategy. Rather than relying solely on suppression, modern fire management emphasizes the creation of "Defensible Space"—the modification of vegetation around structures to interrupt the fuel continuity.</p>
          <p>However, creating defensible space requires a nuanced understanding of fuel types. Not all vegetation burns equally. "Light fuels" like dry grass and scrub ignite easily and burn quickly but produce less intense heat. "Heavy fuels" like dense timber or thick logs take longer to ignite but burn with intense, sustained heat that can compromise structural integrity from a distance. A crucial, often overlooked aspect of survival is identifying "Fuel Breaks"—natural or man-made areas where there is insufficient combustible material to sustain a fire. Large patches of barren rock, bodies of water, or wide paved roads can serve as sanctuaries. When evacuation routes are compromised, identifying and reaching these fuel-free zones within the landscape can be the difference between life and death.</p>
        </div>

        <div class="question">
          <div class="qtext">
            35. Refer to the figure below. The diagram depicts a mountainous terrain with a fire starting at the bottom of a canyon (Point A). Based on the principles of topography and the "Chimney Effect" described in the passage, which evacuation route offers the highest probability of survival?
          
            <div style="text-align:center; margin: 15px 0;">
              <img src="Gemini_Generated_Image_33slwp33slwp33sl.png" alt="Wildfire Evacuation Map" style="width: 35%; border: 1px solid #ccc; border-radius: 4px; box-shadow: 0 2px 5px rgba(0,0,0,0.1);">
            </div>

          </div>
          <div class="options"><label><input type="radio" name="q35" value="A"> A. Route W</label><label><input type="radio" name="q35" value="B"> B. Route X</label><label><input type="radio" name="q35" value="C"> C. Route Y</label><label><input type="radio" name="q35" value="D"> D. Route Z</label></div>
        </div>

        <div class="question">
          <div class="qtext">36. According to the passage, why does fire travel faster uphill?</div>
          <div class="options"><label><input type="radio" name="q36" value="A"> A. The force of gravity pulls burning debris downwards, creating a back-burn.</label><label><input type="radio" name="q36" value="B"> B. The oxygen concentration is higher at higher altitudes, fueling combustion.</label><label><input type="radio" name="q36" value="C"> C. The wind at the top of a mountain is always stronger than at the base.</label><label><input type="radio" name="q36" value="D"> D. The tilted flames radiate heat directly onto the unburned fuel ahead, pre-drying it.</label></div>
        </div>

        <div class="question">
          <div class="qtext">37. Which of the following best explains the "Chimney Effect" mentioned in the third paragraph?</div>
          <div class="options"><label><input type="radio" name="q37" value="A"> A. It describes how smoke accumulates in valleys during high-pressure weather systems.</label><label><input type="radio" name="q37" value="B"> B. It is the phenomenon where a fire in a narrow canyon creates its own updraft, accelerating the blaze upwards.</label><label><input type="radio" name="q37" value="C"> C. It refers to the tendency of homeowners to leave chimneys uncleaned, leading to house fires.</label><label><input type="radio" name="q37" value="D"> D. It explains how fire spreads downwards into basements due to the weight of carbon dioxide.</label></div>
        </div>

        <div class="question">
          <div class="qtext">38. What is the author’s perspective on "Spotting"?</div>
          <div class="options"><label><input type="radio" name="q38" value="A"> A. It is a helpful phenomenon that allows firefighters to locate the fire's edge.</label><label><input type="radio" name="q38" value="B"> B. It is a rare occurrence that only happens in man-made structures.</label><label><input type="radio" name="q38" value="C"> C. It is a dangerous mechanism that allows fire to jump over barriers and containment lines.</label><label><input type="radio" name="q38" value="D"> D. It is the primary method used to create defensible space around homes.</label></div>
        </div>

        <div class="passage">
          <h3>Passage 2</h3>
          <p>In the intricate tapestry of the global economy, few tools are as politically potent and economically controversial as the tariff. A tariff, in its simplest definition, is a tax imposed by a government on imported goods. Historically, tariffs served as a primary source of national revenue before the advent of modern income tax systems. Today, however, they are primarily wielded as instruments of trade policy—protectionist shields designed to shelter domestic industries from foreign competition or geopolitical levers used to penalize adversarial nations. While the political rhetoric surrounding tariffs often frames them as a means to "save jobs" or "level the playing field," the economic reality is far more complex, involving a redistribution of wealth that produces distinct winners and losers.</p>
          <p>To understand the mechanics, one must distinguish between the two main types of tariffs: specific tariffs and ad valorem tariffs. A specific tariff is a fixed fee levied on a physical unit of an imported good (e.g., $10 per imported tire), regardless of its price. In contrast, an <strong>ad valorem</strong> tariff is calculated as a percentage of the good's value (e.g., a 25% tax on the price of imported steel). When a country imposes either type, the immediate effect is an increase in the domestic price of the imported good. This price hike forces foreign exporters to either absorb the cost, lowering their profit margins, or pass it on to consumers.</p>
          <p>The economic consequences can be analyzed through the concepts of "consumer surplus" and "producer surplus." When an imported product becomes more expensive due to a tariff, domestic producers of similar goods can raise their prices or capture a larger market share, thereby increasing their producer surplus. The government also gains revenue from the tariff collection. However, these gains come at a cost. Consumers are forced to pay higher prices for the same goods, reducing their purchasing power and overall consumer surplus. Crucially, economic theory posits that the loss to consumers almost always exceeds the combined gain of the producers and the government.</p>
          <p>This net loss in total societal welfare is technically termed <strong>deadweight loss</strong>. It represents economic value that has effectively evaporated—transactions that would have benefitted both buyer and seller but never happened because of the artificial price distortion. For example, if a consumer values a shoe at $100 and the world price is $90, they would buy it. But if a tariff raises the price to $110, the purchase does not occur. The consumer loses the satisfaction of the shoe, the manufacturer loses the sale, and the government collects $0 in tax revenue because no transaction took place. This is the "invisible cost" of protectionism: the wealth that was never created due to inefficiency.</p>
          <p>Furthermore, tariffs rarely exist in a vacuum. They often trigger "retaliatory tariffs" from trading partners, leading to a trade war. In a trade war, countries exchange tit-for-tat punitive measures, escalating barriers that choke global supply chains. A tariff intended to protect domestic steelworkers might unintentionally devastate domestic automakers, who now face higher costs for raw materials. Thus, while tariffs can offer temporary relief to specific sectors, economists generally argue that they act as a drag on long-term global prosperity, prioritizing sectoral interests over aggregate economic efficiency.</p>
        </div>

        <div class="question">
          <div class="qtext">39. The passage describes <strong>deadweight loss</strong> as the net destruction of economic value caused by market distortion. Based on the context, which of the following scenarios best illustrates this concept?</div>
          <div class="options"><label><input type="radio" name="q39" value="A"> A. A government collects a large amount of tax revenue from luxury car imports, using the money to build new roads.</label><label><input type="radio" name="q39" value="B"> B. A local farmer sells more apples because imported apples have become too expensive due to a new tax.</label><label><input type="radio" name="q39" value="C"> C. A customer decides not to buy a laptop because a tariff has pushed its price above what they are willing to pay, resulting in no sale and no tax revenue.</label><label><input type="radio" name="q39" value="D"> D. A foreign company decides to lower its production costs to keep its product price competitive despite the new tariff.</label></div>
        </div>

        <div class="question">
          <div class="qtext">40. What distinction does the author make between "specific tariffs" and "ad valorem tariffs"?</div>
          <div class="options"><label><input type="radio" name="q40" value="A"> A. Specific tariffs apply to luxury goods, while ad valorem tariffs apply to necessities.</label><label><input type="radio" name="q40" value="B"> B. Specific tariffs are a fixed amount per unit, while ad valorem tariffs are a percentage of value.</label><label><input type="radio" name="q40" value="C"> C. Specific tariffs are paid by the consumer, while ad valorem tariffs are paid by the government.</label><label><input type="radio" name="q40" value="D"> D. Specific tariffs are illegal under international law, while ad valorem tariffs are common.</label></div>
        </div>

        <div class="question">
          <div class="qtext">41. According to the passage, what is the "invisible cost" of protectionism?</div>
          <div class="options"><label><input type="radio" name="q41" value="A"> A. The hidden fees that shipping companies charge to transport goods across borders.</label><label><input type="radio" name="q41" value="B"> B. The money the government spends on policing borders to prevent smuggling.</label><label><input type="radio" name="q41" value="C"> C. The cost of printing new price tags and updating software to reflect new tax rates.</label><label><input type="radio" name="q41" value="D"> D. The economic activity and wealth creation that simply vanishes because transactions are discouraged by high prices.</label></div>
        </div>

        <div class="question">
          <div class="qtext">42. Which of the following is mentioned as a potential negative side effect of imposing tariffs to protect a specific domestic industry (e.g., steel)?</div>
          <div class="options"><label><input type="radio" name="q42" value="A"> A. It might cause other domestic industries (e.g., automakers) to suffer from higher raw material costs.</label><label><input type="radio" name="q42" value="B"> B. It usually leads to a decrease in the quality of domestic goods due to lack of competition.</label><label><input type="radio" name="q42" value="C"> C. It forces the government to lower income taxes to compensate for the tariff revenue.</label><label><input type="radio" name="q42" value="D"> D. It encourages foreign companies to completely relocate their factories to the protecting country.</label></div>
        </div>

        <div class="passage">
          <h3>Passage 3</h3>
          <p>In the quest to create autonomous machines that can navigate the world as safely—or more safely—than humans, engineers face a fundamental problem: how to make a computer "see." While humans rely on binocular vision to perceive depth and identify objects, machines require a suite of sensors to replicate this capability. For years, the debate in the autonomous vehicle (AV) industry has centered on the ideal sensor stack. Traditional cameras are excellent at reading signs and perceiving color but struggle in low light and lack precise depth perception. Radar is robust in bad weather and measures speed well but lacks resolution. Into this gap steps a technology that has transformed fields ranging from robotics to archaeology: LiDAR (Light Detection and Ranging).</p>
          <p>LiDAR functions on the principle of "Time of Flight." Ideally situated on the roof of a vehicle, a LiDAR unit spins at high speeds, firing millions of laser pulses per second in every direction. When these pulses hit an object—a pedestrian, a tree, or another car—they bounce back to the sensor. By measuring the exact time it takes for the light to return, the system calculates the distance to that object with millimeter-level precision. The output is not a flat, 2D photograph, but a "Point Cloud"—a rich, three-dimensional geometric map of the surroundings consisting of millions of individual data points.</p>
          <p>This capability makes LiDAR distinctively superior in specific scenarios. Unlike cameras, which are passive sensors relying on ambient light, LiDAR is an active sensor; it brings its own light source. This means it functions perfectly in total darkness, detecting the precise shape and distance of a pedestrian crossing a pitch-black highway where a camera might see only a blur. Moreover, LiDAR can "see through" occlusions. In archaeology, airborne LiDAR has revolutionized the mapping of ancient civilizations. By filtering out the laser returns from leaves and branches, researchers can digitally strip away the dense Amazonian canopy to reveal the ground structures of lost Mayan cities hidden beneath the jungle floor.</p>
          <p>However, LiDAR is not without its limitations. The technology is historically expensive, complex to manufacture, and contains moving mechanical parts that can fail. Furthermore, its performance degrades in atmospheric obscurants. Heavy rain, thick fog, or snow can scatter the laser pulses before they hit their target, creating "noise" in the data—a situation where Radar often outperforms LiDAR. Additionally, while the point cloud provides impeccable geometric data, it is generally monochromatic. A LiDAR sensor can tell you that an object is shaped like a stop sign, but it cannot tell you if the sign is red (Stop) or green (Go), nor can it read the text on a speed limit sign.</p>
          <p>Because of these trade-offs, the prevailing consensus in the industry—with notable dissenters like Tesla—is that no single sensor is sufficient. The future of autonomy lies in "Sensor Fusion," where the high-resolution texture of cameras, the velocity tracking of radar, and the precise depth mapping of LiDAR are combined to create a redundant and robust model of the world.</p>
        </div>

        <div class="question">
          <div class="qtext">
            43. An autonomous vehicle is driving on a highway at night. The dashboard displays the sensor visualization shown in the figure below to warn the driver of an obstacle ahead. Based on the technical characteristics described in the passage, which sensor is generating the specific visual data on the right side of the figure?
            
            <div style="text-align:center; margin: 15px 0;">
              <img src="Gemini_Generated_Image_ptysllptysllptys.png" alt="LiDAR Sensor Visualization" style="width: 35%; border: 1px solid #ccc; border-radius: 4px; box-shadow: 0 2px 5px rgba(0,0,0,0.1);">
            </div>

          </div>
          <div class="options"><label><input type="radio" name="q43" value="A"> A. The LiDAR</label><label><input type="radio" name="q43" value="B"> B. The Radar</label><label><input type="radio" name="q43" value="C"> C. The Camera</label><label><input type="radio" name="q43" value="D"> D. The Ultrasonic Sensor</label></div>
        </div>

        <div class="question">
          <div class="qtext">44. What is the fundamental difference between how a Camera and a LiDAR sensor operate, according to the text?</div>
          <div class="options"><label><input type="radio" name="q44" value="A"> A. Cameras rely on ambient light to capture 2D images, while LiDAR fires laser pulses to measure 3D distance.</label><label><input type="radio" name="q44" value="B"> B. Cameras are active sensors that generate light, while LiDAR is a passive sensor.</label><label><input type="radio" name="q44" value="C"> C. Cameras use sound waves to detect objects, while LiDAR uses radio waves.</label><label><input type="radio" name="q44" value="D"> D. Cameras are better at measuring distance, while LiDAR is better at reading colors and signs.</label></div>
        </div>

        <div class="question">
          <div class="qtext">45. Why has LiDAR been particularly useful for archaeologists working in tropical rainforests?</div>
          <div class="options"><label><input type="radio" name="q45" value="A"> A. It creates heat maps that can detect ancient campfires buried underground.</label><label><input type="radio" name="q45" value="B"> B. Its data can be filtered to remove vegetation layers, revealing the shape of man-made structures on the ground.</label><label><input type="radio" name="q45" value="C"> C. It provides high-resolution color photography that helps identify specific plant species used by ancient people.</label><label><input type="radio" name="q45" value="D"> D. It can detect the chemical signature of gold and other precious metals used in artifacts.</label></div>
        </div>

        <div class="question">
          <div class="qtext">46. Which of the following is mentioned as a major physical limitation of LiDAR technology?</div>
          <div class="options"><label><input type="radio" name="q46" value="A"> A. It cannot function in total darkness.</label><label><input type="radio" name="q46" value="B"> B. It cannot determine the shape of an object.</label><label><input type="radio" name="q46" value="C"> C. It struggles to identify color and text, and its signal is scattered by heavy rain or fog.</label><label><input type="radio" name="q46" value="D"> D. It is illegal to use on public roads due to eye-safety regulations.</label></div>
        </div>
      </div>

      <div class="quiz-section">
        <h2>第六大題：混合題（占 10 分）</h2>
        <div class="passage">
          <p>As the world transitions toward renewable energy, a persistent problem remains: how to store electricity from the wind and sun for times when the air is still or the sky is dark. Traditional lithium-ion batteries are excellent for short-term needs, but they are expensive, environmentally taxing to mine, and lose their charge over long periods. Enter the "Sand Battery"—a groundbreaking thermal energy storage system developed by Finnish engineers that uses common sand to store green energy for months at a time.</p>
          <p>The core of the system is a tall, insulated steel silo filled with hundreds of tons of low-grade sand. When there is an excess of wind or solar power, the electricity is used to heat the sand up to 600°C ($1112$°F) through resistive heating (the same process used in electric toasters). Because sand is an incredibly effective insulator, it can retain this heat with minimal loss for an entire season. When energy demand increases during the cold winter months, the system discharges by blowing air through the hot sand. The heated air is then used to warm water for district heating systems, providing warmth to homes and offices.</p>
          <p>The beauty of the sand battery lies in its sustainability and simplicity. Unlike chemical batteries that require rare metals like cobalt or lithium, sand is abundant and cheap. Furthermore, the system has no risk of explosion and a significantly longer lifespan than traditional battery cells. While it currently excels at providing heat rather than converting heat back into electricity, it represents a massive leap in managing the intermittency of renewable energy.</p>
          <p>However, the technology is still in its infancy. For sand batteries to be adopted worldwide, significant infrastructure changes are required to integrate thermal storage into existing power grids. Despite these hurdles, this "ancient" material is proving to be a futuristic solution in our battle against climate change, proving that sometimes the most high-tech solutions are hidden in the simplest substances.</p>
        </div>

        <div class="question">
          <div class="qtext">47-48 下列為針對「沙電池（Sand Batteries）」技術特性的總結表。請根據上文內容，填入最合適的單詞（word），並視句型結構需要做適當的字形變化，使語意完整、語法正確。每格限填一個單詞。（填充，各 2 分，共 4 分）</div>
          <table class="mixed-table">
            <tr><th>Aspect of Technology</th><th>Descriptions and Findings</th></tr>
            <tr>
              <td>Material Advantage</td>
              <td>The widespread <input type="text" class="mixed-input" name="q47" placeholder="Q47"> of sand makes it a more sustainable and budget-friendly alternative to the rare minerals found in traditional batteries.</td>
            </tr>
            <tr>
              <td>Practical Application</td>
              <td>Currently, the technology is primarily utilized for the <input type="text" class="mixed-input" name="q48" placeholder="Q48"> of thermal energy to residential and commercial buildings.</td>
            </tr>
          </table>
        </div>

        <div class="question">
          <div class="qtext">49. Based on the passage, which of the following statements are true? (多選題，4分，依倒扣公式計算)</div>
          <div class="options">
            <label><input type="checkbox" name="q49" value="A"> (A) Sand batteries are less likely to cause accidental fires or blasts than chemical ones.</label>
            <label><input type="checkbox" name="q49" value="B"> (B) The sand battery is currently a perfect solution for converting heat into electricity.</label>
            <label><input type="checkbox" name="q49" value="C"> (C) The efficiency of sand as an insulator allows for long-term storage of thermal energy.</label>
            <label><input type="checkbox" name="q49" value="D"> (D) The mining process for sand battery materials is as environmentally damaging as lithium mining.</label>
            <label><input type="checkbox" name="q49" value="E"> (E) To implement sand batteries on a large scale, the current power grid system needs modification.</label>
            <label><input type="checkbox" name="q49" value="F"> (F) High-grade, expensive sand is required to ensure the heating system works effectively.</label>
          </div>
        </div>

        <div class="question">
          <div class="qtext">50. Based on the information in the first paragraph, with which two of the weather elements will it be optimal for producing renewable energy? (填空題，共2分，錯一格即不給分)</div>
          <div class="q50-container">
            <div class="q50-item"><input type="text" class="q50-input" id="q50_1" placeholder="Element 1"></div>
            <div class="q50-item"><input type="text" class="q50-input" id="q50_2" placeholder="Element 2"></div>
          </div>
          <div id="q50-feedback" class="correct-answer" style="display:none; color:#16a34a; margin-top:10px;">
            <strong>參考答案：</strong> wind, sun (順序不拘)
          </div>
        </div>
      </div>

      <div class="quiz-section">
        <h2>第七大題：非選題（占 28 分）</h2>
        
        <h3>Part 1: 中譯英（8分）</h3>
        <p class="hint">說明：依題號將以下中文句子譯成正確、通順、達意的英文。每題 4 分。</p>

        <div class="question">
          <div class="qtext">1. 當青少年過度依賴社群媒體來獲得認同 (approval) 時，他們往往會陷入焦慮與自我懷疑。</div>
          <textarea id="trans1" class="trans-input" placeholder="請輸入翻譯..."></textarea>
        </div>
        <div class="question">
          <div class="qtext">2. 專家建議我們應該建立健康的數位習慣，以防止社交平台對我們的心理健康造成負面影響。</div>
          <textarea id="trans2" class="trans-input" placeholder="請輸入翻譯..."></textarea>
        </div>
        <button type="button" class="primary" id="gradeTransBtn" style="background-color: #059669; font-size:1rem; padding:10px; margin-top:10px;">AI 批改中譯英 (使用Groq)</button>
        
        <div id="transResult" class="ai-grading-result" style="background-color: #f0f9ff; border-color: #bae6fd;">
          <h3>中譯英 AI 批改結果</h3>
          <div class="score-grid">
             <div class="score-item"><span class="score-label">第1題得分</span><span class="score-value" id="scoreTrans1">--</span></div>
             <div class="score-item"><span class="score-label">第2題得分</span><span class="score-value" id="scoreTrans2">--</span></div>
             <div class="score-item"><span class="score-label">總分</span><span class="score-value" id="scoreTransTotal">--</span></div>
          </div>
          <div class="translation-result-box">
            <div class="feedback-title">第 1 題評語與建議：</div>
            <div id="feedbackTrans1" class="trans-feedback"></div>
          </div>
          <div class="translation-result-box">
             <div class="feedback-title">第 2 題評語與建議：</div>
             <div id="feedbackTrans2" class="trans-feedback"></div>
          </div>
        </div>

        <hr style="margin: 30px 0;">

        <h3>Part 2: 英文作文（20分）</h3>
        <p class="hint">說明：依據提示寫一篇約 120 字以上的短文。</p>
        
        <div class="passage">
          <p><strong>題目說明：</strong></p>
          <p>想像你正準備開啟一段全新的人生旅程（例如：前往一個完全陌生的環境生活），由於限制，你只能挑選三項對你生命意義最重大、且最能代表「你是誰」的元素（這可以包含具體的私人物品、一種長期維持的生活習慣、或是一個深刻影響你的生命經驗）。請你針對這個情境，寫一篇兩段式的英文作文，文長不少於 120 字。第一段中，請具體說明這三項元素分別是什麼，並充分論述你的選擇理由，說明它們如何連結了你的過去，並將如何幫助你面對未來的挑戰；第二段中則請你分享如果有一天你被迫失去了這一切外在的連結（物品被毀、環境變遷導致習慣中斷），你認為你原本的性格與價值觀是否會因此改變？請用你的個人經驗或信念支持你的立場，並總結在不斷變動的世界中，我們應該如何守護那些真正屬於自己、誰也拿不走的內在特質。</p>
        </div>

        <div class="essay-container">
          <textarea id="essayInput" placeholder="請在此輸入您的作文 (Please type your essay here)..."></textarea>
          <div class="word-count">字數統計: <span id="wordCountDisplay">0</span></div>
          <button type="button" class="primary" id="gradeEssayBtn" style="background-color: #7c3aed; width:100%; font-size:1.1rem; padding:12px;">AI 批改作文 (使用Groq)</button>
        </div>

        <div id="aiResult" class="ai-grading-result">
          <h3>AI 批改結果</h3>
          
          <details class="correction-dropdown" open>
            <summary>
              <span>👀 查看文章詳細訂正 (紅字=錯誤, 藍字=建議)</span>
              <div class="legend-box">
                <span class="legend-dot" style="background:#dc2626;"></span>錯誤
                <span class="legend-dot" style="background:#2563eb; margin-left:8px;"></span>優化
              </div>
            </summary>
            <div id="markedEssayDisplay" class="essay-correction-content">
              </div>
          </details>

          <div class="score-grid">
            <div class="score-item"><span class="score-label">內容 (Content)</span><span class="score-value" id="scoreContent">--</span></div>
            <div class="score-item"><span class="score-label">組織 (Org)</span><span class="score-value" id="scoreOrg">--</span></div>
            <div class="score-item"><span class="score-label">文法 (Grammar)</span><span class="score-value" id="scoreGrammar">--</span></div>
            <div class="score-item"><span class="score-label">字彙 (Vocab)</span><span class="score-value" id="scoreVocab">--</span></div>
          </div>
          
          <div class="total-score">總分：<span id="scoreTotal">--</span> / 20</div>
          
          <div id="feedbackContainer" style="margin-top: 20px;"></div>
        </div>
      </div>

      <div style="margin-top:30px; display:flex; gap:15px; justify-content:center;">
        <button type="button" class="primary" id="submitBtn" style="font-size:1.1rem; padding:12px 24px;">提交與顯示計分</button>
        <button type="reset" class="secondary" id="resetFormBtn">重做</button>
      </div>
      <div style="margin-top:15px; text-align:center;">
        <label style="display:inline-block;">
          <input type="checkbox" id="showAnswersCheckbox"> 顯示正確答案
        </label>
        <p style="font-size:0.9rem; color:#555; margin-top:4px;">請按下提交後再點擊 "顯示正確答案" (含簡答題參考答案)</p>
      </div>
      <div id="results"></div>

    </form>
  </div>

  <script>
    // ===== 全局變數儲存分數狀態 (Global Score State) =====
    let currentScores = {
      vocab: 0,
      cloze: 0,
      context: 0,
      struct: 0,
      reading: 0,
      mixed: 0,
      trans: 0,
      essay: 0
    };

    function updateScoreboardDisplay() {
      document.getElementById('dash-vocab').textContent = currentScores.vocab;
      document.getElementById('dash-cloze').textContent = currentScores.cloze;
      document.getElementById('dash-context').textContent = currentScores.context;
      document.getElementById('dash-struct').textContent = currentScores.struct;
      document.getElementById('dash-reading').textContent = currentScores.reading;
      document.getElementById('dash-mixed').textContent = currentScores.mixed.toFixed(1).replace('.0', '');
      
      const transTxt = (currentScores.trans === 0 && document.getElementById('scoreTransTotal').textContent === '--') ? '--' : currentScores.trans;
      document.getElementById('dash-trans').textContent = transTxt;
      
      const essayTxt = (currentScores.essay === 0 && document.getElementById('scoreTotal').textContent === '--') ? '--' : currentScores.essay;
      document.getElementById('dash-essay').textContent = essayTxt;
      
      const total = currentScores.vocab + currentScores.cloze + currentScores.context + currentScores.struct + 
                    currentScores.reading + currentScores.mixed + currentScores.trans + currentScores.essay;
      
      document.getElementById('dash-total').textContent = total.toFixed(1).replace('.0', '');
      
      // 更新分數時自動展開計分面板
      autoOpenDashboard();
    }

    // ===== 1. 計分板收合控制邏輯 =====
    document.getElementById('dashboard-toggle-btn').addEventListener('click', function() {
      const dashboard = document.getElementById('score-dashboard');
      const btn = this;
      
      dashboard.classList.toggle('collapsed');
      
      if (dashboard.classList.contains('collapsed')) {
        btn.textContent = '⬇ 顯示成績';
      } else {
        btn.textContent = '⬆ 收起面板';
      }
    });
    
    function autoOpenDashboard() {
        const dashboard = document.getElementById('score-dashboard');
        const btn = document.getElementById('dashboard-toggle-btn');
        if(dashboard.classList.contains('collapsed')) {
            dashboard.classList.remove('collapsed');
            btn.textContent = '⬆ 收起面板';
        }
    }

    // ===== 2. 計時器收合控制邏輯 =====
    document.getElementById('timer-toggle-btn').addEventListener('click', function() {
      const timerBar = document.getElementById('timer-bar');
      const btn = this;
      
      timerBar.classList.toggle('collapsed');
      
      if (timerBar.classList.contains('collapsed')) {
        btn.textContent = '⏱ 顯示計時器';
      } else {
        btn.textContent = '⬆ 收起設定';
      }
    });

    // ===== Timer Logic =====
    let countdownInterval = null;
    let remainingSeconds = 0;
    let locked = false;

    function formatTime(sec) {
      const m = Math.floor(sec / 60);
      const s = sec % 60;
      const mm = m.toString().padStart(2,'0');
      const ss = s.toString().padStart(2,'0');
      return `${mm}:${ss}`;
    }
    function updateTimerLabel(prefix) {
      const timer = document.getElementById('timer');
      timer.textContent = `${prefix} ${formatTime(remainingSeconds)}`;
    }
    function lockExam() {
      locked = true;
      document.querySelectorAll('#examForm input, #examForm select, #examForm textarea').forEach(el => el.disabled = true);
      document.getElementById('lockedBanner').style.display = 'block';
    }
    function startCountdown() {
      if (locked) return;
      const minutes = parseInt(document.getElementById('countdownTime').value, 10);
      if (!minutes || !confirm(`倒數將從 ${minutes} 分鐘開始。是否開始？`)) return;
      remainingSeconds = minutes * 60;
      updateTimerLabel('剩餘');
      document.getElementById('pauseBtn').disabled = false;
      document.getElementById('resetTimerBtn').disabled = false;
      document.getElementById('startBtn').disabled = true;
      document.getElementById('resumeBtn').disabled = true;
      if (countdownInterval) clearInterval(countdownInterval);
      countdownInterval = setInterval(() => {
        remainingSeconds -= 1;
        if (remainingSeconds <= 0) {
          remainingSeconds = 0;
          updateTimerLabel('剩餘');
          clearInterval(countdownInterval);
          lockExam();
          alert('時間到！');
        } else {
          updateTimerLabel('剩餘');
        }
      }, 1000);
    }
    function pauseCountdown() {
      if (!countdownInterval) return;
      clearInterval(countdownInterval);
      countdownInterval = null;
      document.getElementById('pauseBtn').disabled = true;
      document.getElementById('resumeBtn').disabled = false;
    }
    function resumeCountdown() {
      if (countdownInterval || locked) return;
      document.getElementById('pauseBtn').disabled = false;
      document.getElementById('resumeBtn').disabled = true;
      countdownInterval = setInterval(() => {
        remainingSeconds -= 1;
        if (remainingSeconds <= 0) {
          remainingSeconds = 0;
          clearInterval(countdownInterval);
          lockExam();
        } else {
          updateTimerLabel('剩餘');
        }
      }, 1000);
    }
    function resetCountdown() {
      if (countdownInterval) clearInterval(countdownInterval);
      countdownInterval = null;
      remainingSeconds = 0;
      document.getElementById('timer').textContent = '尚未開始';
      document.getElementById('pauseBtn').disabled = true;
      document.getElementById('resumeBtn').disabled = true;
      document.getElementById('resetTimerBtn').disabled = true;
      document.getElementById('startBtn').disabled = false;
    }
    document.getElementById('startBtn').addEventListener('click', startCountdown);
    document.getElementById('pauseBtn').addEventListener('click', pauseCountdown);
    document.getElementById('resumeBtn').addEventListener('click', resumeCountdown);
    document.getElementById('resetTimerBtn').addEventListener('click', resetCountdown);

    // ===== Answer Key & Grading Logic =====
    const ANSWERS_MCQ = {
      q1:'A', q2:'B', q3:'B', q4:'C', q5:'C', q6:'A', q7:'C', q8:'D', q9:'D', q10:'B',
      q11:'A', q12:'B', q13:'C', q14:'D', q15:'A', q16:'B', q17:'A', q18:'C', q19:'D', q20:'A',
      q21:'G', q22:'A', q23:'C', q24:'B', q25:'D', q26:'E', q27:'F', q28:'J', q29:'H', q30:'I',
      q31:'C', q32:'A', q33:'D', q34:'B',
      q35:'C', q36:'D', q37:'B', q38:'C', q39:'C', q40:'B', q41:'D', q42:'A', q43:'A', q44:'A', q45:'B', q46:'C'
    };
    
    // 混合題客觀題答案
    const ANSWERS_MIXED = {
        q47: 'abundance',
        q48: 'provision',
        q49_correct: ['A', 'C', 'E'], // 正確選項
        q50_keywords: ["wind", "sun"] // 嚴格答案
    };

    function grade() {
      const res = document.getElementById('results');
      res.innerHTML = '';
      
      // 重置各部分分數
      currentScores.vocab = 0;
      currentScores.cloze = 0;
      currentScores.context = 0;
      currentScores.struct = 0;
      currentScores.reading = 0;
      currentScores.mixed = 0;
      
      // 1. 改選擇題 (1-46)
      for (let i = 1; i <= 46; i++) {
        const name = 'q' + i;
        const correct = ANSWERS_MCQ[name];
        const checked = document.querySelector(`input[name="${name}"]:checked`) || document.querySelector(`select[name="${name}"]`);
        let val = checked ? checked.value : '';
        if (checked && checked.tagName === 'SELECT' && checked.value === '') val = ''; 
        
        let point = 1;
        if(i >= 31 && i <= 34) point = 2; // 篇章結構
        if(i >= 35 && i <= 46) point = 2; // 閱讀測驗
        
        if (!val) {
            res.innerHTML += `<p class="wrong">第 ${i} 題未作答｜正確：<span class="correct-answer" style="display:inline">${correct}</span></p>`;
        } else if (val === correct) { 
            // 累加分數
            if(i<=10) currentScores.vocab += point;
            else if(i<=20) currentScores.cloze += point;
            else if(i<=30) currentScores.context += point;
            else if(i<=34) currentScores.struct += point;
            else currentScores.reading += point;

            res.innerHTML += `<p class="correct">第 ${i} 題答對 ✔</p>`; 
        } else {
            res.innerHTML += `<p class="wrong">第 ${i} 題答錯 ✘ (你選 ${val})｜正確：<span class="correct-answer" style="display:inline">${correct}</span></p>`;
        }
      }

      // 2. 改混合題 (47-50)
      // Q47 (2分)
      const q47Val = document.querySelector('input[name="q47"]').value.trim().toLowerCase();
      if(q47Val === ANSWERS_MIXED.q47) currentScores.mixed += 2;
      else res.innerHTML += `<p class="wrong">第 47 題答錯 (你填 ${q47Val || '未作答'})｜正確：abundance</p>`;
      
      // Q48 (2分)
      const q48Val = document.querySelector('input[name="q48"]').value.trim().toLowerCase();
      if(ANSWERS_MIXED.q48.includes(q48Val)) currentScores.mixed += 2;
      else res.innerHTML += `<p class="wrong">第 48 題答錯 (你填 ${q48Val || '未作答'})｜正確：provision</p>`;
      
      // Q49 (4分) - 新邏輯: (n-2k)/n * 4
      const allOptions = ['A', 'B', 'C', 'D', 'E', 'F'];
      const correctSet = new Set(ANSWERS_MIXED.q49_correct);
      const userCheckedEls = document.querySelectorAll('input[name="q49"]:checked');
      const userSet = new Set(Array.from(userCheckedEls).map(el => el.value));
      
      let k = 0; // 錯誤數
      allOptions.forEach(opt => {
         const isCorrect = correctSet.has(opt);
         const isUserChecked = userSet.has(opt);
         // 該選沒選 或 不該選選了 -> 記錯
         if (isCorrect !== isUserChecked) {
             k++;
         }
      });
      
      const n = 6;
      let q49Score = 0;
      if (userSet.size > 0) { // 有作答才算分
          let ratio = (n - 2 * k) / n;
          if (ratio < 0) ratio = 0;
          q49Score = ratio * 4;
      }
      currentScores.mixed += q49Score;
      
      let q49Msg = (q49Score === 4) ? "全對" : (q49Score === 0) ? "0分" : "部分得分";
      if(q49Score < 4) res.innerHTML += `<p class="wrong">第 49 題 ${q49Msg} (${q49Score.toFixed(2)}分)｜正確：A, C, E</p>`;
      else res.innerHTML += `<p class="correct">第 49 題答對 (${q49Score}分) ✔</p>`;


      // Q50 (2分) - 新題目與邏輯: 兩個空格，嚴格匹配 "wind", "sun"
      const q50_1 = document.getElementById('q50_1').value.trim().toLowerCase();
      const q50_2 = document.getElementById('q50_2').value.trim().toLowerCase();
      const userAnsSet = new Set([q50_1, q50_2]);
      const correctAnsSet = new Set(ANSWERS_MIXED.q50_keywords);

      // 檢查是否包含正確集合
      // 邏輯: 兩個填答內容必須剛好是 "wind" 和 "sun" (允許順序互換)
      // 若有一格錯或空白，則 Set 比對失敗 -> 0分
      let q50Correct = true;
      if (userAnsSet.size !== 2) q50Correct = false; // 可能填重複或少填
      for (let ans of correctAnsSet) {
          if (!userAnsSet.has(ans)) q50Correct = false;
      }
      
      if (q50Correct) {
          currentScores.mixed += 2;
          res.innerHTML += `<p class="correct">第 50 題答對 ✔</p>`;
      } else {
          res.innerHTML += `<p class="wrong">第 50 題答錯 (錯一格即不給分)｜正確：wind, sun</p>`;
      }

      // 更新上方計分板
      updateScoreboardDisplay();
      
      res.scrollIntoView({ behavior: 'smooth' });
    }
    
    document.getElementById('submitBtn').addEventListener('click', grade);
    
    document.getElementById('resetFormBtn').addEventListener('click', () => {
      document.getElementById('results').innerHTML = '';
      document.getElementById('aiResult').style.display = 'none';
      document.getElementById('transResult').style.display = 'none';
      document.getElementById('wordCountDisplay').textContent = '0';
      document.querySelectorAll('textarea').forEach(el => el.value = '');
      document.querySelectorAll('input[type="text"]').forEach(el => el.value = '');
      document.querySelectorAll('input[type="radio"]').forEach(el => el.checked = false);
      document.querySelectorAll('input[type="checkbox"]').forEach(el => el.checked = false);
      document.querySelectorAll('select').forEach(el => el.selectedIndex = 0);
      
      // 重置分數
      currentScores = { vocab: 0, cloze: 0, context: 0, struct: 0, reading: 0, mixed: 0, trans: 0, essay: 0 };
      document.getElementById('scoreTransTotal').textContent = '--';
      document.getElementById('scoreTotal').textContent = '--';
      updateScoreboardDisplay();
    });
    
    document.getElementById('showAnswersCheckbox').addEventListener('change', function() {
      const show = this.checked;
      document.querySelectorAll('.correct-answer').forEach(el => el.style.display = show ? 'inline' : 'none');
      // 顯示混合題正確答案
      if(show) {
          document.querySelector('input[name="q47"]').value = ANSWERS_MIXED.q47 + ' (Ans)';
          document.querySelector('input[name="q48"]').value = ANSWERS_MIXED.q48[0] + ' (Ans)';
          document.getElementById('q50_1').value = "wind (Ans)";
          document.getElementById('q50_2').value = "sun (Ans)";
          document.getElementById('q50-feedback').style.display = 'block';
      } else {
           document.getElementById('q50-feedback').style.display = 'none';
      }
    });

    // =============================================================
    // ★★★ 設定 API KEY (使用原設定) ★★★
    let API_KEY = "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"; 
    // =============================================================

    // ===== Translation AI Grading Logic =====
    document.getElementById('gradeTransBtn').addEventListener('click', async function() {
        const t1 = document.getElementById('trans1').value.trim();
        const t2 = document.getElementById('trans2').value.trim();
        const resultBox = document.getElementById('transResult');
        const btn = this;

        if(!t1 || !t2) {
            alert("請完成兩題翻譯後再進行批改。");
            return;
        }

        btn.disabled = true;
        btn.innerHTML = '<span class="ai-loading-anim">✨</span> AI 批改中...';
        resultBox.style.display = 'none';

        const prompt = `
        You are a strict English grader for Taiwan's GSAT exam. 
        Please grade the following two Chinese-to-English translations.
        
        Question 1 Source: 當青少年過度依賴社群媒體來獲得認同 (approval) 時，他們往往會陷入焦慮與自我懷疑。
        Student Answer 1: "${t1}"
        
        Question 2 Source: 專家建議我們應該建立健康的數位習慣，以防止社交平台對我們的心理健康造成負面影響。
        Student Answer 2: "${t2}"

        Scoring Rules:
        - Max 4 points per question. Total 8 points.
        - Deduct 0.5 points for each grammatical error, spelling mistake, or wrong vocabulary.
        - Deduct 0.5 - 1.0 point for awkward phrasing (Chinglish).
        - If the meaning is completely wrong, give 0.
        - If any error is spotted, do not ignore it, be as strict as possible.
        - Check if the translation fully captures the original meaning.
        - Check if the grammar is completely correct. If not, deduct points accordingly no matter how minor or the student conveys the correct meaning,
        - Check the tiniest details, including articles, prepositions, verb tenses, subject-verb agreement, and word forms.
        - Strictly follow the scoring rules above without exception.


        Output format (JSON ONLY):
        {
            "q1_score": number (0-4),
            "q1_feedback": "Specific feedback in Traditional Chinese...",
            "q2_score": number (0-4),
            "q2_feedback": "Specific feedback in Traditional Chinese...",
            "total_score": number
        }
        `;

        try {
            const response = await fetch("https://api.groq.com/openai/v1/chat/completions", {
                method: "POST",
                headers: { "Authorization": `Bearer ${API_KEY}`, "Content-Type": "application/json" },
                body: JSON.stringify({
                    messages: [
                        { role: "system", content: "You are a helpful assistant that outputs strictly in JSON." },
                        { role: "user", content: prompt }
                    ],
                    model: "llama-3.3-70b-versatile",
                    temperature: 0.1,
                    response_format: { type: "json_object" }
                })
            });

            if (!response.ok) throw new Error("API Connection Failed");
            const data = await response.json();
            const resData = JSON.parse(data.choices[0].message.content);

            document.getElementById('scoreTrans1').textContent = resData.q1_score;
            document.getElementById('scoreTrans2').textContent = resData.q2_score;
            document.getElementById('scoreTransTotal').textContent = resData.total_score;
            document.getElementById('feedbackTrans1').textContent = resData.q1_feedback;
            document.getElementById('feedbackTrans2').textContent = resData.q2_feedback;
            
            // 更新全局分數與看板
            currentScores.trans = resData.total_score;
            updateScoreboardDisplay();

            resultBox.style.display = 'block';

        } catch (e) {
            console.error(e);
            alert("批改失敗，請檢查網路或稍後再試。");
        } finally {
            btn.disabled = false;
            btn.textContent = "AI 批改中譯英 (使用Groq)";
        }
    });


    // ===== Essay AI Grading Logic =====
    const essayInput = document.getElementById('essayInput');
    const wordCountDisplay = document.getElementById('wordCountDisplay');

    essayInput.addEventListener('input', function() {
      const text = this.value.trim();
      const words = text === '' ? 0 : text.split(/\s+/).length;
      wordCountDisplay.textContent = words;
      if (words < 120) wordCountDisplay.style.color = 'red';
      else if (words < 250) wordCountDisplay.style.color = 'orange';
      else wordCountDisplay.style.color = 'green';
    });

    document.getElementById('gradeEssayBtn').addEventListener('click', async function() {
      const essayText = essayInput.value.trim();
      const resultDiv = document.getElementById('aiResult');
      const feedbackContainer = document.getElementById('feedbackContainer');
      const btn = this;
      const wordCount = essayText === '' ? 0 : essayText.split(/\s+/).length;

      if (wordCount < 10) {
        alert("作文字數太少，請至少寫幾個完整的句子。");
        return;
      }

      btn.disabled = true;
      btn.innerHTML = '<span class="ai-loading-anim">✨</span> 正在深入分析 (需要 10-20 秒，請耐心等候)...';
      resultDiv.style.display = 'none';

      const topic = `
        題目：Three Essential Elements for a New Life Journey
        背景：開啟一段全新的人生旅程，只能帶三項代表「你是誰」的元素。
        要求：兩段式作文，第一段三元素與理由；第二段失去後的反思。
        `;

      const systemPrompt = `
        You are a STRICT and UNCOMPROMISING English Examination Grader for high school students in Taiwan (GSAT standard).
        Your goal is NOT to encourage, but to accurately assess proficiency.      
        *** CRITICAL SCORING RULES (MUST FOLLOW) ***
        1. **Low Score Threshold**: If the essay has multiple basic grammar errors (e.g., subject-verb disagreement like 'It remind', wrong tense like 'I choose' for past events, Chinglish), the Grammar score MUST be between 0 and 3.5 (out of 5). DO NOT give 3.5 or higher for poor grammar.
        2. **Word Count Penalty**: If the essay is significantly short (under 120 words) or lacks substance, the TOTAL SCORE must be capped at 12.
        3. **Total Score Calculation**: Sum of 4 sub-scores (Content + Organization + Grammar + Vocab). Max 20.
           - Average / Passable essay: 12-14 points.
           - Poor essay with frequent errors: 8-11 points.
           - Excellent essay: 16+ points.
           - Outstanding essay with advanced vocab/structure: 18-20 points (minimum word count 300, strictly follow this rule when giving higher marks).
        4. **The score can have a 0.5 or 1.0 point increment (e.g., 12.0, 12.5, 13.0, etc.) but no points such as 16.3 or 17.6.**
        5. **For any essay that the word count is between 120 and 250 words, total score cannot exceed 15 points.**
        6. **For essays that don't have too much mistakes (less than four grammar or vocabulary errors), deduct 0.5 points when a mistake is spotted.**
        7. **If the essay is over 250 words and has good grammar (4 or fewer mistakes), you may reward up to 1 extra point for exceeding the word count requirement.**
        8. **For essays that does not meet the two-paragraph structure requirement, deduct 1 point from the Organization score and the total point cannot exceed 10.**
        9. **If the essay fails to address the prompt (e.g., missing one of the required elements), deduct 1 point from the Content score for 1 miss.**
        10. **If the essay is completely off-topic, give a total score of 0 and provide feedback explaining the reason.**
        11. **Carefully check for "Chinglish" issues (unnatural phrasing, direct translations from Chinese, etc.) and deduct points accordingly.**
        12. **Be careful about the logic and coherence of the essay. If there are significant logic flaws, deduct points from Organization.**
        13. **Carefully examines every sentence and if there are redundant or repetitive expressions, deduct points from Vocabulary.**
        14. **Only for essays that are above 300 words can have a total score higher than 18 points.**
        15. **Total review or feedback must be in Traditional Chinese (繁體中文) and must exceed 1000 words (as long and as detailed as possible).**
        16. **If the essay content is unrelated to the given topic, the total score must be 0.**
        17. **Strictly obey ALL the above rules without exception.**

        *** TASK 1: DUAL-COLOR MARKING (CRITICAL) ***
        Rewrite the student's essay EXACTLY, but insert tags for corrections and improvements.
        
        1. [RED ERRORS]: Mark grammar/spelling mistakes with \`[ERR: original :: correction]\`. When the usage of a vocabulary is grammarly and structurally correct but there's words that's more suitable to the scenario, do NOT mark it as an error, mark as optimization which will be mentioned below instead.
           - Example: "He [ERR: go :: went] to school."
           - Be as strict as possible. EVERY error MUST be marked.
           - Strictly follow the rules above without any exceptions.
        
        2. [BLUE OPTIMIZATIONS] (MANDATORY): You MUST identify at least 3-5 opportunities to improve vocabulary or phrasing, EVEN IF the original is grammatically correct.
           - Replace simple words (e.g., "good", "think", "make") with advanced alternatives (e.g., "beneficial", "perceive", "generate").
           - Format: \`[OPT: original :: better_alternative]\`.
           - Example: "I [OPT: think :: believe] that technology is [OPT: good :: beneficial]."
           - However, for words that are already advanced or contextually appropriate, do NOT mark them.
        
        *** TASK 2: FEEDBACK (EXTREMELY VERBOSE) ***
        You must provide VERY LONG feedback in Traditional Chinese (繁體中文).
        - Please analyze based on the specific topic: "${topic}"
        - Check if the student mentioned 3 elements, linked past/future, and discussed losing them (Paragraph 2).
        - Provide DETAILED feedback on Content, Organization, Grammar, and Vocabulary, citing specific examples from the essay.
        - Each feedback section must be at least 300 words (in Traditional Chinese) long, with in-depth analysis and suggestions.
        - Using phrases or idioms is totally fine, if the usage is correct, do not mark them as optimizations.
        - When constructing feedback, do not use generic phrases like "文章的內容充實，有清晰的主題陳述" unless you provide specific examples from the essay to support such claims. BE AS SPECIFIC AS POSSIBLE.
        - Strictly follow the rules above without any exceptions.
        - When there are sufficient reasons to give extremely high marks, it is not necessary to give feedbacks such as "文章的詞彙選擇基本豐富，但仍需要進一步的優化和充實".
        - For judging the usage of vocabulary, please refer to the Taiwan's criteria for high school English exams (GSAT standard). For higher scores, students must use words that are in level five or six.
        - When constructing feedback, you can use examples from the student's essay to illustrate your points, but do NOT copy large chunks of text directly into the feedback. Instead, paraphrase or summarize the relevant parts. 

        *** OUTPUT FORMAT (JSON ONLY) ***
        {
          "marked_essay_text": "Full text with [ERR:...] and [OPT:...] tags...",
          "content": number (0-5),
          "organization": number (0-5),
          "grammar": number (0-5),
          "vocab": number (0-5),
          "total": number (0-20),
          "feedback_general": "總評 (針對是否切題、字數、邏輯進行長篇分析)...",
          "feedback_structure": "結構分析 (第一段是否涵蓋三元素與理由、第二段是否深入反思)...",
          "feedback_grammar": "文法與修辭深度解析...",
          "feedback_vocab": "高分優化建議..."
        }
        
        IMPORTANT: Rewrite the essay exactly. When inserting a tag, replace the original text with the tag. DO NOT leave the original text outside the tag. Example: '[ERR: cat :: dog]' is correct. 'cat [ERR: cat :: dog]' is WRONG (causes duplication).
        `;

      try {
        const response = await fetch("https://api.groq.com/openai/v1/chat/completions", {
          method: "POST",
          headers: {
            "Authorization": `Bearer ${API_KEY}`,
            "Content-Type": "application/json"
          },
          body: JSON.stringify({
            messages: [
              { role: "system", content: systemPrompt },
              { role: "user", content: `Topic: ${topic}\nWord Count: ${wordCount}\nStudent Essay:\n"${essayText}"` }
            ],
            model: "llama-3.3-70b-versatile",
            temperature: 0.1, 
            response_format: { type: "json_object" }
          })
        });

        if (!response.ok) throw new Error(`API Error: ${response.status}`);

        const data = await response.json();
        const rawText = data.choices[0].message.content;
        const resultData = JSON.parse(rawText);

        // Process Tags
        let formattedEssay = resultData.marked_essay_text || "無法產生批改範例";
        formattedEssay = formattedEssay.replace(/</g, "&lt;").replace(/>/g, "&gt;");
        formattedEssay = formattedEssay.replace(/([a-zA-Z]+)\s*(\[(?:ERR|OPT):\s*\1\s*::)/gi, "$2");
        formattedEssay = formattedEssay.replace(/\[ERR:\s*(.*?)\s*::\s*(.*?)\]/g, '<span class="mark-error" data-suggestion="$2">$1</span>');
        formattedEssay = formattedEssay.replace(/\[OPT:\s*(.*?)\s*::\s*(.*?)\]/g, '<span class="mark-opt" data-suggestion="$2">$1</span>');
        formattedEssay = formattedEssay.replace(/\n/g, '<br>');

        document.getElementById('markedEssayDisplay').innerHTML = formattedEssay;
        document.getElementById('scoreContent').textContent = resultData.content || 0;
        document.getElementById('scoreOrg').textContent = resultData.organization || 0;
        document.getElementById('scoreGrammar').textContent = resultData.grammar || 0;
        document.getElementById('scoreVocab').textContent = resultData.vocab || 0;
        document.getElementById('scoreTotal').textContent = resultData.total || 0;

        feedbackContainer.innerHTML = `
          <div class="feedback-box"><span class="feedback-title">總評與切題度分析</span><div class="feedback-content">${resultData.feedback_general}</div></div>
          <div class="feedback-box"><span class="feedback-title">結構與邏輯分析</span><div class="feedback-content">${resultData.feedback_structure}</div></div>
          <div class="feedback-box"><span class="feedback-title">文法糾錯與修辭解析</span><div class="feedback-content">${resultData.feedback_grammar}</div></div>
          <div class="feedback-box"><span class="feedback-title">單字升級與高分建議</span><div class="feedback-content">${resultData.feedback_vocab}</div></div>
        `;
        
        // 更新全局分數與看板
        currentScores.essay = resultData.total;
        updateScoreboardDisplay();

        resultDiv.style.display = 'block';
        resultDiv.scrollIntoView({ behavior: 'smooth', block: 'start' });

      } catch (error) {
        console.error("Grading Error:", error);
        alert(`批改發生錯誤：\n${error.message}`);
      } finally {
        btn.disabled = false;
        btn.textContent = "AI 批改作文 (使用Groq)";
      }
    });
  </script>
</body>

</html>
